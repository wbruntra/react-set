(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{127:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),l=a.n(c),o=(a(76),a(6)),s=a(5),i=a(30),m=a(18),u=a(34),d=a.n(u),p=a(42),f=a(2),E=a(9),v=a(32),h=a(62),b=a(63),g=a(22),y=a.n(g);const N=e=>({type:"UPDATE_USER",payload:e}),O=e=>({type:"UPDATE_NICKNAME",payload:e}),j={loading:!0,user:{}},S={user:(e=j,t)=>{switch(t.type){case"UPDATE_USER":return Object(f.a)({},e,{},t.payload);case"UPDATE_NICKNAME":return y()(e,{user:{nickname:{$set:t.payload}}});case"LOGOUT":return{loading:!1,user:null};default:return e}}};var w=Object(v.createStore)(Object(v.combineReducers)(S),Object(b.composeWithDevTools)(Object(v.applyMiddleware)(h.a))),T=a(10),k=a.n(T),F=(a(33),a(38),{apiKey:"AIzaSyCLA_RFXrPvBdN_vrApCUlj28a82ownuzg",authDomain:"fire-set.firebaseapp.com",databaseURL:"https://fire-set.firebaseio.com",projectId:"fire-set",storageBucket:"fire-set.appspot.com",messagingSenderId:"958559518798",appId:"1:958559518798:web:ec451bbfb4ac03f30ec31f",measurementId:"G-FCHHM3FEZE"});T.initializeApp(F);var D=T.firestore();var C=function(){var e=Object(E.c)(),t=Object(i.f)();return r.a.createElement("div",{className:"my-3",style:{cursor:"pointer"}},r.a.createElement("p",{className:"text-right text-white"},r.a.createElement("a",{className:"btn btn-danger",onClick:function(){k.a.auth().signOut().then((function(){e({type:"LOGOUT"}),console.log("Signed out."),t.push("/")}))}},"Sign Out")))},I=a(3),x=a(16),R=function(e){return Object(x.a)(Array(e).keys())},M=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;t=4===a?R(3).map((function(t){return R(4).map((function(a){return e.includes(4*t+a)?"x":"o"})).join("")})):R(4).map((function(t){return R(3).map((function(a){return e.includes(3*t+a)?"x":"o"})).join("")})),console.log(t.join("\n"))},P=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.debug,n=void 0!==a&&a,r=t.returnWhenFound,c=void 0!==r&&r,l=0,o=[],s=0;s<e.length-2;s++)for(var i=s+1;i<e.length-1;i++)for(var m=i+1;m<e.length;m++)if(o=[e[s],e[i],e[m]],A(o)&&(n&&M([s,i,m]),l++,c))return l;return l},G=function(){var e=[];return R(3).forEach((function(t){R(3).forEach((function(a){R(3).forEach((function(n){R(3).forEach((function(r){var c=""+t+n+a+r;e.push(c)}))}))}))})),e},A=function(e){if(3!==e.length)return!1;for(var t=Object(o.a)(e,3),a=t[0],n=t[1],r=t[2],c=0;c<4;c++){if((Number(a[c])+Number(n[c])+Number(r[c]))%3!==0)return!1}return!0},U=function(e,t){return t.includes(e)?t.filter((function(t){return t!==e})):[].concat(Object(x.a)(t),[e])},B=function(e){for(var t=e.board,a=void 0===t?[]:t,n=e.deck,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=Object(I.shuffle)([].concat(Object(x.a)(a),Object(x.a)(n)));P(l.slice(0,r))<c&&P(l,{returnWhenFound:!0})>0;)l=Object(I.shuffle)(l);return{deck:l.slice(r),board:l.slice(0,r)}},V=function(e){var t=e.board,a=e.deck,n=e.selected,r=a.slice(0,3),c=Object(x.a)(t),l=a.slice(3);for(n.forEach((function(e,t){var a=c.indexOf(e);c[a]=r[t]}));0===P(c);){var o=B({board:c,deck:l});l=o.deck,c=o.board}return{deck:l,board:c,selected:[]}},_=function(){var e=new T.auth.GoogleAuthProvider;T.auth().signInWithRedirect(e)},z=function(e,t){("string"===typeof e?D.collection("games").doc(e):e).update(Object(f.a)({},t,{lastUpdate:T.firestore.FieldValue.serverTimestamp()}))},L=a(23),H=a(24),W=a(27),K=a(26),$=(a(88),120),J=200,Y=4,q=25,X=function(e){var t=e.fill,a=e.color,n=Y;return r.a.createElement("svg",{width:"120",height:"200",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",null,r.a.createElement("rect",{fill:"#fff",id:"canvas_background",height:"202",width:"122",y:"-1",x:"-1"}),r.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},r.a.createElement("rect",{fill:"#fff",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),r.a.createElement("g",null,r.a.createElement("path",{stroke:a,transform:" rotate(270,58.8,98) scale(0.8 1) translate(10 0) ",id:"svg_5",d:" m-17.49,66 c50.83,-35.45 101.7,35.45 152.5,0 c30,-10 30,43.8 0,63.8 c-50.8,35.45 -101.6,-35.45 -152.5,0 c-30,15 -30,-45 0,-63.59 z ",fillOpacity:"null",strokeOpacity:"null",strokeWidth:n,fill:t})))},Z=function(e){var t=e.shape,a=e.fill,n=e.color,c=q,l=J,o=$;return"0"===t?(c+=1,r.a.createElement(X,{fill:a,color:n})):"1"===t?r.a.createElement("g",null,r.a.createElement("ellipse",{stroke:n,ry:(l-2*c)/2,rx:(o-2*c)/2,cy:l/2,cx:o/2,fillOpacity:"null",strokeOpacity:"null",strokeWidth:Y,fill:a})):"2"===t?r.a.createElement("g",null,r.a.createElement("polygon",{points:"".concat(c,",").concat(l/2,"\n          ").concat(o/2,",").concat(c,"\n          ").concat(o-c,",").concat(l/2,"\n          ").concat(o/2,",").concat(l-c),style:{fill:a,stroke:n,strokeWidth:Y}})):void 0},Q=function(e){Object(W.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(L.a)(this,a);for(var c=arguments.length,l=new Array(c),s=0;s<c;s++)l[s]=arguments[s];return(e=t.call.apply(t,[this].concat(l))).colors={0:"#00A91D",1:"#311b92",2:"#FF0000",white:"#fff"},e.getFill=function(t,a){return"1"===a?"url(#card-".concat(t,"-").concat(a,")"):"2"===a?e.colors[t]:e.colors.white},e.drawShape=function(){var t=e.props.desc.split(""),a=Object(o.a)(t,4),c=a[1],l=a[2],s=a[3];return r.a.createElement(n.Fragment,null,r.a.createElement("g",null,r.a.createElement("title",null,"background"),r.a.createElement("rect",{fill:e.colors.white,id:"canvas_background",y:"-1",x:"-1"}),r.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},r.a.createElement("rect",{strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),r.a.createElement(Z,{shape:l,fill:e.getFill(c,s),color:e.colors[c]}))},e}return Object(H.a)(a,[{key:"render",value:function(){var e=this,t=this.props.desc.split(""),a=Object(o.a)(t,4),n=a[0],c=a[1],l=a[3];return r.a.createElement("div",{className:"game-card"},r.a.createElement("svg",{width:"0",height:"0"},r.a.createElement("pattern",{id:"card-".concat(c,"-").concat(l),width:10,height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse"},r.a.createElement("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:this.colors[c],strokeWidth:"5"}}))),R(Number(n)+1).map((function(t){return r.a.createElement("svg",{key:t,className:"shape",viewBox:"0 0 ".concat($," ").concat(J),xmlns:"http://www.w3.org/2000/svg"},e.drawShape())})))}}]),a}(n.Component),ee=a(65),te=a.n(ee),ae=a(66),ne=a.n(ae);var re=function(e){var t=e.gameOver,a=e.myName,n=e.solo,c=Object(E.d)((function(e){return e.user})).user;return r.a.createElement("div",{className:"game-over container mt-5"},function(){var e=t===a?ne.a:te.a;return r.a.createElement("audio",{src:e,autoPlay:!0})}(),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-md-6"},r.a.createElement("div",{className:"card shadow"},r.a.createElement("h3",{className:"text-center mt-3"},"GAME OVER!"),r.a.createElement("p",{className:"text-center mb-4"},"Winner: ",t," "),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-4"},r.a.createElement("p",{className:"text-center"},r.a.createElement(s.b,{to:"/"},"Main"))),n&&null!==c&&r.a.createElement("div",{className:"col-4"},r.a.createElement("p",{className:"text-center"},r.a.createElement(s.b,{to:"/stats"},"Stats"))))))))},ce=["light-blue","pink","amber","light-green","purple","orange"];var le=function(e){var t=e.gameMode,a=(e.deck,e.board),n=e.declarer,c=e.setsFound,l=(e.startTime,e.elapsedTime),o=P(a);switch(t){case"shared-device":return null;case"versus":return r.a.createElement("div",{className:"topbar py-2 bg-".concat(n?"light":"dark","-orange")},r.a.createElement("nav",{className:"container text-white"},r.a.createElement("div",{className:"row justify-content-between text-center"},r.a.createElement("div",{className:"col"},"Sets: ",o),r.a.createElement("div",{className:"col"},n&&r.a.createElement(r.a.Fragment,null,"SET! ",n)))));case"puzzle":return r.a.createElement("div",{className:"navbar-fixed"},r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper",style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,"Total Sets: ",o),r.a.createElement("div",null,"Remaining: ",o-c.length),r.a.createElement("div",null,"Time: ",function(e){var t=Math.floor(e/60),a=e-60*t;return"".concat(t,":").concat(function(e){return("00"+e).slice(-"00".length)}(a))}(l)))));default:return null}},oe=a(13);function se(e){var t=e.players,a=e.declarer,n=e.handlePlayerClick;return r.a.createElement("div",{className:"row my-4 text-center justify-content-between"},t.map((function(e){return r.a.createElement("div",{className:"col-2 bg-".concat(e.color," ").concat(e.name==a?"active-player":""),onClick:function(){n(e.name)},key:e.name},r.a.createElement("p",{className:"my-2 align-middle"},e.name==a?"SET!":e.score))})))}var ie=function(e){var t=Object(n.useState)(null),a=Object(o.a)(t,2),c=(a[0],a[1]),l=Object(n.useState)(window.innerHeight),s=Object(o.a)(l,2),i=(s[0],s[1]),m=e.board,u=e.selected,d=(e.deck,e.declarer),p=e.players,E=e.gameOver,v=e.myName,h=e.setFound,b=e.sharedDevice,g=e.solo,y=e.gameMode;Object(n.useEffect)((function(){var e=Object(I.debounce)((function(){i(window.innerHeight)}),150);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(n.useEffect)((function(){c(P(m,{debug:!1}))}),[m]);var N=function(e){var t=e.declarer,a=e.players;return t?Object(I.get)(a,"".concat(t,".color"),""):Object(I.get)(a,"".concat(v,".color"),"")}(e);if(!Object(I.isEmpty)(E))return r.a.createElement(re,{gameOver:E,myName:v,solo:g});var O=Object(I.map)(p,(function(e,t){return Object(f.a)({name:t},e)})),j=Math.ceil(O.length/2),S=O.slice(0,j),w=O.slice(j);return r.a.createElement(n.Fragment,null,(Object(I.isEmpty)(p)||!Object.keys(p).includes(v))&&r.a.createElement(oe.a,{show:!0},r.a.createElement(oe.a.Header,null,r.a.createElement(oe.a.Title,null,"Waiting to join...")),r.a.createElement(oe.a.Body,null,r.a.createElement("h4",null,"Players:"),r.a.createElement("ul",{className:"collection"},Object(I.map)(p,(function(e,t){return r.a.createElement("li",{key:t,className:"collection-item"},r.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)"))}))))),r.a.createElement(le,e),r.a.createElement("div",{className:"container"},b&&r.a.createElement(se,{players:S,declarer:d,handlePlayerClick:e.handlePlayerClick}),r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"row"},m.map((function(t){return r.a.createElement("div",{key:t,className:"card-column col-4",onClick:function(){e.handleCardClick(t)}},r.a.createElement("div",{className:"card-holder ".concat(u.includes(t)?"bg-".concat(N):"")},r.a.createElement("div",{className:"card ".concat(h&&3===u.length&&!u.includes(t)?"blurry":"")},r.a.createElement(Q,{desc:t}))))}))),!b&&"puzzle"!==y&&r.a.createElement("div",{className:"row text-center my-3"},Object(I.map)(p,(function(e,t){return r.a.createElement("div",{key:t,className:"col s4 m3"},r.a.createElement("span",{className:"player-name bg-".concat(e.color)},t,": ",e.score))}))),b&&r.a.createElement(se,{players:w,declarer:d,handlePlayerClick:e.handlePlayerClick}),e.handleRedeal&&r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col mt-3 mt-md-4"},r.a.createElement("button",{onClick:e.handleRedeal,className:"btn btn-primary"},"Shuffle"))))))};var me=function(e){var t=e.isHost,a=e.players,n=e.setState;return Object(I.findKey)(a,(function(e){return e.host})),r.a.createElement("div",{className:"container mt-4"},r.a.createElement("h4",null,"Players:"),r.a.createElement("ul",{className:"collection"},Object(I.map)(a,(function(e,t){return r.a.createElement("li",{key:t,className:"collection-item"},r.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)"))}))),t?r.a.createElement("button",{className:"btn btn-primary",onClick:function(){n({gameStarted:!0})}},"Start Game"):r.a.createElement("p",null,"Waiting for host to start game..."))},ue={turnTime:5e3,colors:ce,playingTo:6};var de=function(){var e=Object(E.d)((function(e){return e.user})),t=e.user,a=e.loading,c=Object(E.c)(),l=Object(n.useRef)({}).current,i=G(),u=Object(f.a)({},B({deck:i.slice(12),board:i.slice(0,12)}),{selected:[]}),v=Object(n.useState)(),h=Object(o.a)(v,2),b=h[0],g=h[1],N=Object(n.useState)(""),j=Object(o.a)(N,2),S=j[0],w=j[1],T=Object(n.useState)(),F=Object(o.a)(T,2),x=F[0],R=F[1],M=Object(n.useState)(),P=Object(o.a)(M,2),L=P[0],H=(P[1],Object(n.useState)()),W=Object(o.a)(H,2),K=W[0],$=W[1],J=Object(n.useState)(Object(f.a)({gameTitle:"",players:{},created:!1,gameStarted:!1,myName:"",setFound:!1,declarer:null,gameOver:""},u)),Y=Object(o.a)(J,2),q=Y[0],X=Y[1],Z=Object(n.useRef)(q);Z.current=q,Object(n.useEffect)((function(){t&&!Object(I.isEmpty)(t.uid)&&D.collection("games").where("creator_uid","==",t.uid).get().then((function(e){e.forEach((function(e){console.log(e.id);var t=Object(f.a)({},e.data(),{gameTitle:e.id});console.log("Old game: ",t),g(t)}))})).catch((function(e){console.log("Error getting documents: ",e)}))}),[t]),Object(n.useEffect)((function(){return function(){K&&K(),L&&L()}}),[L,K]),Object(n.useEffect)((function(){return function(){window.clearInterval(x)}}),[x]);var Q=function(e){X(Object(f.a)({},Z.current,{},e))},ee=function(e){var t=("string"===typeof e?D.collection("games").doc(e):e).collection("actions");return console.log(t),t.onSnapshot((function(e){console.log("got action snapshot"),e.docChanges().forEach((function(e){if("added"===e.type){var a=e.doc.data();console.log(a),ae(a),t.doc(e.doc.id).delete()}"removed"===e.type&&console.log("Removed action: ",e.doc.data())}))})),t},te=function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.game=D.collection("games").doc(t),a=window.setInterval((function(){z(l.game,{})}),3e4),R(a),n=ee(l.game),$(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t=e.type,a=e.payload,n=Z.current,r=n.players,c=n.declarer,l=n.board;switch(t){case"join":if(Object.keys(r).includes(a.name))return;var o=Object(f.a)({},r,Object(m.a)({},a.name,{host:!1,uid:a.uid,score:0,color:ue.colors[Object.keys(r).length]}));re({players:o});break;case"found":!c&&ce(l,a.selected)&&le(a.selected,a.name);break;default:return}},ne=function(e,t){if(A(e)){var a=function(e){if(!e)return{};var t=Z.current.players,a=t[e].score+1,n=y()(t,Object(m.a)({},e,{$merge:{score:a}})),r=a>=ue.playingTo?e:"";return r&&window.setTimeout((function(){l.game.delete(),clearInterval(x)}),3e3),{players:n,gameOver:r}}(t),n=Object(f.a)({},Z.current,{setFound:!1,declarer:null},a,{},V(Z.current));re(n)}},re=function(e){console.log("updating",Z.current.gameTitle),Q(e),z(l.game,e)},ce=function(e,t){for(var a=0;a<t.length;a++)if(!e.includes(t[a]))return!1;return!0},le=function(e,t){var a={setFound:A(e),selected:e,declarer:t};re(a),a.setFound&&setTimeout((function(){ne(e,t)}),4e3)},oe=q.board,se=q.deck,de=q.selected,pe=q.declarer,fe=q.players,Ee=q.created,ve=q.gameStarted,he=q.myName;return a?"Loading...":Object(I.isEmpty)(t)?r.a.createElement("div",{className:"container mt-4"},r.a.createElement("p",null,"To host a game, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:_,className:"btn btn-info"},"Sign in"))):b&&!q.created?r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"You are already hosting a game. Return to it?"),r.a.createElement("button",{className:"btn btn-primary mr-5",onClick:function(){return function(){var e=Object(I.findKey)(b.players,(function(e){return e.host})),t=b.gameTitle;Q({gameTitle:t}),te(t),Q(Object(f.a)({myName:e,created:!0},b,{lastUpdate:k.a.firestore.FieldValue.serverTimestamp()}))}()}},"YES!"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(){var e=b.gameTitle;D.collection("games").doc(e).delete().then((function(){console.log("Deleted old game"),g(void 0)}))}},"No, remove it")):""===he?r.a.createElement("div",{className:"container"},r.a.createElement(C,null),r.a.createElement("h4",null,"Enter your nickname:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),Q({myName:t.nickname,players:Object(m.a)({},t.nickname,{host:!0,uid:t.uid,score:0,color:ue.colors[0]})})}},r.a.createElement("div",{className:"row mb-4"},r.a.createElement("div",{className:"col-md-3 mb-3 mr-md-4"},r.a.createElement("input",{autoFocus:!0,placeholder:"hostname",value:t.nickname,onChange:function(e){c(O(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit")))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(s.b,{to:"/"},"Main Menu")))):Ee?ve?r.a.createElement(ie,{board:oe,deck:se,selected:de,declarer:pe,handleCardClick:function(e){var t=q.myName;if(!q.declarer){var a=U(e,q.selected);A(a)&&le(a,t),Q({selected:a})}},handleRedeal:function(){var e=B(q);re(e)},players:fe,setFound:q.setFound,gameOver:q.gameOver,myName:q.myName,gameMode:"versus"}):r.a.createElement(me,{isHost:!0,players:fe,setState:re}):r.a.createElement("div",{className:"container mt-4"},r.a.createElement("h4",null,"Name your game:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=q.myName,n=q.board,r=q.deck,c=q.selected,o=q.players,s=q.gameOver,i=Object(I.isEmpty)(S)?"".concat(a,"'s game"):S;Q({gameTitle:i}),l.game=D.collection("games").doc(i),l.game.set({creator_uid:t.uid,players:o,board:n,deck:r,selected:c,gameOver:s,lastUpdate:k.a.firestore.FieldValue.serverTimestamp()});var m=window.setInterval((function(){l.game.update({lastUpdate:k.a.firestore.FieldValue.serverTimestamp()})}),3e4);R(m),l.actions=ee(i),console.log(l.actions),Q({created:!0})}},r.a.createElement("div",{className:"mb-3"},r.a.createElement("input",{autoFocus:!0,placeholder:"".concat(he,"'s game"),onChange:function(e){w(e.target.value)},value:S})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create"))))},pe=a(68);var fe=function(e){var t=Object(E.d)((function(e){return e.user})),a=t.user,c=(t.loading,Object(E.c)()),l=Object(n.useState)({popupVisible:!1,setFound:!1,displayAnimation:!1,animatedSet:[],declarer:"",deck:[],board:[],selected:[],pending:null,gameStarted:!1}),i=Object(o.a)(l,2),m=i[0],u=i[1],d=Object(n.useState)(""),p=Object(o.a)(d,2),v=p[0],h=p[1],b=Object(n.useState)(),g=Object(o.a)(b,2),y=(g[0],g[1],Object(n.useRef)({}).current),N=Object(n.useRef)(m);N.current=m;var j=function(e){u(Object(f.a)({},N.current,{},e))},S=function(){var e=N.current,t=e.declarer,a=e.selected;Object(I.isEmpty)(t)&&3===a.length&&!A(a)&&j({selected:[]})},w=function(e){console.log("Creating on",y.actions),y.actions.add(Object(f.a)({},e,{created:k.a.firestore.FieldValue.serverTimestamp()})).then((function(t){if("found"===e.type){var a=t.id;console.log("Document written with ID: ",a),j({pending:a})}}))};Object(n.useEffect)((function(){var t=e.match.params.gameName;y.game=D.collection("games").doc(t);var a=y.game.onSnapshot((function(e){!function(e){var t=Object(f.a)({},e.data()),a=N.current.selected;if(!Object(I.isEmpty)(t)){console.log("Updating",t);var n=a.length<3&&Object(I.isEmpty)(t.declarer)?a:t.selected;console.log("New selected",n),j(Object(f.a)({},t,{selected:n,popupVisible:!1}))}}(e)}));y.actions=y.game.collection("actions");var n=y.actions.onSnapshot((function(e){e.docChanges().forEach((function(e){"removed"===e.type&&(N.current.pending===e.doc.id&&(console.log("Pending action removed!"),j({pending:null})))}))}));return function(){y.game&&a(),y.actions&&n()}}),[]);var T=m.board,F=m.deck,x=m.selected,R=m.declarer,M=m.players,P=m.popupVisible;if(t.loading)return"Loading profile...";if(Object(I.isEmpty)(a))return r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"To join a game, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:_,className:"btn btn-info"},"Sign in")),r.a.createElement("p",null,r.a.createElement(s.b,{to:"/lobby"},"Back")));if(!v)return r.a.createElement("div",{className:"container"},r.a.createElement(C,null),r.a.createElement("h4",{className:"mb-3"},"Choose your nickname:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=a.nickname;if(!Object(I.isEmpty)(t)){h(t);var n={type:"join",payload:{name:t,uid:a.uid}};w(n)}}},r.a.createElement("div",{className:"col-12 col-md-4"},r.a.createElement("input",{autoFocus:!0,type:"text",placeholder:"your name",value:a.nickname,onChange:function(e){c(O(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}})),r.a.createElement("div",{className:"col-12 col-md-4"},r.a.createElement("input",{className:"btn btn-primary mt-3 ml-md-3",type:"submit",value:"Join"}))));var G=N.current,B=G.setFound,V=G.gameOver;return G.gameStarted?r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{show:m.pending&&P},r.a.createElement(oe.a.Header,null,r.a.createElement(oe.a.Title,null,"Submitting action...")),r.a.createElement(oe.a.Body,null,r.a.createElement("p",{className:"text-center"},"SET!"),r.a.createElement("div",{className:"text-center"},r.a.createElement(pe.a,{animation:"border"})))),r.a.createElement(ie,{board:T,deck:F,selected:x,declarer:R,handleCardClick:function(e){var t=N.current,a=t.declarer,n=t.selected;if(!a){var r=U(e,n);if(!(r.length>3)){var c={};if(3===r.length)if(A(r)){var l={type:"found",payload:{selected:r,name:v}};console.log("Found set, sending..."),w(l),c.popupVisible=!0}else console.log("Bad set selected!"),window.setTimeout(S,1e3);j(Object(f.a)({},c,{selected:r}))}}},players:M,setFound:B,gameOver:V,myName:v,gameMode:"versus"})):r.a.createElement(me,{players:M,isHost:!1})},Ee=function(e){Object(W.a)(a,e);var t=Object(K.a)(a);function a(e){var n;Object(L.a)(this,a),(n=t.call(this,e)).componentWillUnmount=function(){n.unsubscribe()};return n.state={name:"",newGame:"baz",init:!1,games:[]},n}return Object(H.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.gamesRef=D.collection("games"),this.unsubscribe=this.gamesRef.onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(Object(f.a)({name:e.id},e.data()))})),e.setState({init:!0,games:a})}))}},{key:"render",value:function(){var e=this.state,t=e.games,a=e.init;if(console.log(t),!a)return null;var c=t.filter((function(e){var t=e.lastUpdate;if(!t)return!1;var a=t.toMillis(),n=(new Date).getTime();return Math.round((n-a)/1e3)<40}));return r.a.createElement("div",{className:"container",style:{height:"100vh"}},0===c.length?r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-8 col-md-6"},r.a.createElement("div",{className:"card-panel teal",style:{marginTop:.2*window.innerHeight}},r.a.createElement("span",{className:"white-text"},"There are currently no active games.")),r.a.createElement("p",null,"Click ",r.a.createElement(s.b,{to:"/host"},"here")," to host one"),r.a.createElement("p",null,r.a.createElement(s.b,{className:"btn btn-primary",to:"/"},"Back"))))):r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"text-center my-4"},"Available games"),r.a.createElement("div",{className:"row align-content-center"},c.map((function(e,t){return r.a.createElement("div",{className:"col-6 col-md-4",key:e.name},r.a.createElement("div",{className:"card available-game"},r.a.createElement("div",{className:"my-auto text-center"},r.a.createElement(s.b,{to:"/guest/".concat(e.name)},e.name))))}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col mt-4"},r.a.createElement(s.b,{className:"btn btn-primary",to:"/"},"Back")))))}}]),a}(n.Component),ve=a(29),he=a.n(ve),be=a(69),ge=a.n(be),ye=4e3,Ne=ce,Oe=6,je=1200,Se=function(e){var t=Number(e);return Number.isNaN(t)&&(t=1),24e3/(5*t)},we=function(){var e=G();return Object(f.a)({},B({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Te={players:{you:{score:0,color:Ne[0]},cpu:{score:0,color:Ne[1]}},gameStarted:!1,myName:"you",setFound:!1,declarer:null,gameOver:null,cpuTurnInterval:1e3,startTime:new Date},ke=function(e){Object(W.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(L.a)(this,a),(n=t.call(this,e)).handleStartGame=function(e){e.preventDefault(),n.setState({gameStarted:!0,startTime:new Date}),console.log("Turns every ".concat(n.state.cpuTurnInterval," ms")),setTimeout((function(){var e=window.setInterval(n.cpuTurn,n.state.cpuTurnInterval);n.setState({cpuTimer:e})}),je)},n.componentDidMount=function(){var e=window.localStorage.getItem("soloDifficulty"),t=e?Number(e):2,a=Se(t);n.setState({difficulty:t,cpuTurnInterval:a})},n.componentWillUnmount=function(){null!==n.state.cpuTimer&&window.clearInterval(n.state.cpuTimer)},n.cpuTurn=function(){var e=n.state,t=e.board,a=e.declarer,r=e.gameOver;if(!a&&!r){0;var c=Object(I.shuffle)(t).slice(0,2),l=Object(o.a)(c,2),s=l[0],i=l[1],m=function(e,t){for(var a="",n=0;n<4;n++)e[n]===t[n]?a+=e[n]:a+=(3-(Number(e[n])+Number(t[n]))).toString();return a.trim()}(s,i);t.includes(m)&&(n.setState({declarer:"cpu",selected:[s],cpuFound:[i,m],setFound:!0}),null!==n.state.cpuTimer&&clearInterval(n.state.cpuTimer),n.setState({cpuAnimation:window.setInterval(n.animateCpuChoice,900)}))}},n.animateCpuChoice=function(){var e=n.state,t=e.selected,a=e.cpuFound,r=Object(x.a)(a);if(0!==r.length){var c=[].concat(Object(x.a)(t),[r.pop()]);n.setState({cpuFound:r,selected:c}),3===c.length&&(null!==n.state.cpuAnimation&&clearInterval(n.state.cpuAnimation),n.updateSelected(c,"cpu"))}},n.updatePlayerScore=function(e,t){var a=n.state.players,r=a[e].score+t;return[y()(a,Object(m.a)({},e,{$merge:{score:r}})),r]},n.expireDeclare=function(){var e=n.state,t=e.declarer,a=e.selected;if(t&&!A(a)){var r=n.updatePlayerScore(t,-.5),c=Object(o.a)(r,1)[0];n.setState({players:c,declarer:null,timeDeclared:void 0,selected:[]})}},n.markPointForDeclarer=function(e){var t=n.updatePlayerScore(e,1),a=Object(o.a)(t,2),r=a[0],c=a[1],l=n.props.userReducer.user,s=c>=Oe?e:"",i={players:r,gameOver:s};if(!Object(I.isEmpty)(s)){var m=l&&l.uid||"anonymous",u="you"==e?1:0,d=Math.round(((new Date).getTime()-n.state.startTime.getTime())/1e3);he.a.post("/api/game",{uid:m,total_time:d,player_won:u,difficulty_level:n.state.difficulty,winning_score:c}).then((function(){console.log("Game sent")})).catch((function(e){console.log("Error sending game")}))}return n.setState(i),i},n.performDeclare=function(e){if(!n.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};n.setState(t),n.setState({undeclareId:window.setTimeout((function(){n.expireDeclare()}),ye)})}},n.updateSelected=function(e,t){var a={setFound:A(e),selected:e,declarer:t};a.setFound&&(n.state.undeclareId&&clearTimeout(n.state.undeclareId),setTimeout((function(){n.removeSet()}),2e3)),n.setState(a)},n.handleCardClick=function(e){var t=n.state,a=t.setFound,r=t.declarer,c=t.myName;if(!a&&"cpu"!==r){var l=U(e,n.state.selected);r||n.performDeclare(c),n.setState({selected:l}),A(l)&&n.updateSelected(l,"you")}},n.handleRedeal=function(){var e=B(n.state);n.setState(e)},n.removeSet=function(){var e=n.state,t=e.declarer,a=e.selected;if(t&&A(a)){console.log("Set found, removing"),n.markPointForDeclarer(t);var r=Object(f.a)({setFound:!1,declarer:null,timeDeclared:void 0},V(n.state));n.setState(r)}n.state.cpuTimer&&clearInterval(n.state.cpuTimer),setTimeout((function(){var e=window.setInterval(n.cpuTurn,n.state.cpuTurnInterval);n.setState({cpuTimer:e})}),je)},n.resetGame=function(){n.state.cpuTimer&&window.clearInterval(n.state.cpuTimer),n.setState(Object(f.a)({},Object(I.cloneDeep)(Te),{},we()))},n.state=Object(f.a)({},Object(I.cloneDeep)(Te),{},we(),{difficulty:2}),n}return Object(H.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,n=t.deck,c=t.selected,l=t.declarer,o=t.players,i=t.gameStarted,m=(t.setFound,this.props.userReducer),u=m.user;return m.loading?"Loading...":i?r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{board:a,deck:n,selected:c,declarer:l,handleCardClick:this.handleCardClick,handleDeclare:function(){},handleRedeal:this.handleRedeal,players:o,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.myName,resetGame:this.resetGame,solo:!0,gameMode:"versus"})):r.a.createElement("div",{className:"container main-content"},null!==u&&r.a.createElement(C,null),r.a.createElement("h3",{className:"text-center mb-4"},"Solo Play vs. Computer"),r.a.createElement("h4",{className:"mb-4"},"Choose difficulty level:"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("form",{onSubmit:this.handleStartGame},r.a.createElement("div",{className:"col-10 col-md-6 mb-5"},r.a.createElement(ge.a,{maxValue:8,minValue:1,value:this.state.difficulty,onChange:function(t){var a=Se(t);window.localStorage.setItem("soloDifficulty",t.toString()),e.setState({cpuTurnInterval:a,difficulty:t})}})),r.a.createElement("input",{type:"submit",value:"Start",className:"btn btn-primary"})),r.a.createElement("p",{style:{marginTop:"24px"}},"First to ",Oe," points is the winner")),r.a.createElement("div",{className:"row mt-4"},r.a.createElement("ul",{style:{listStyleType:"none"}},r.a.createElement("li",{className:"mb-4"},r.a.createElement(s.b,{to:"/local"},"Local Multiplayer")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/"},"Back to Main Menu"))))),!u&&r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",null,r.a.createElement("p",null,"To save your game statistics, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:_,className:"btn btn-info"},"Sign in")))))}}]),a}(n.Component),Fe=Object(E.b)((function(e){return{userReducer:e.user}}))(ke);function De(e){var t=e.url,a=e.cardName,n=e.description;return r.a.createElement("div",{className:"col-9 col-md-4"},r.a.createElement(s.b,{to:t},r.a.createElement("div",{className:"card shadow-sm mb-3 mb-md-4"},r.a.createElement(Q,{desc:a}))),r.a.createElement("p",{className:"text-center"},n))}var Ce=function(){return r.a.createElement("div",{className:"container mt-3 mt-md-5"},r.a.createElement("h1",{className:"d-none d-md-block text-center mb-3 mb-md-5"},"Main Menu"),r.a.createElement("div",{className:"row justify-content-center"},[{url:"/solo",cardName:"0012",description:"Solo/Local"},{url:"/lobby",cardName:"1121",description:"Join Game"},{url:"/host",cardName:"2200",description:"Host Game"}].map((function(e,t){return r.a.createElement(De,Object.assign({key:"card-".concat(t)},e))}))),r.a.createElement("div",{className:"d-none d-md-block"},r.a.createElement("hr",null),r.a.createElement("p",null,r.a.createElement(s.b,{to:"/rules"},"Rules")),r.a.createElement("p",null,r.a.createElement(s.b,{to:"/stats"},"View Statistics"))))};function Ie(e){var t=e.desc;return r.a.createElement("div",{className:"col-4 my-2"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:t})))}var xe=function(){return r.a.createElement("div",{className:"rules container"},r.a.createElement("h2",null,"Rules of the Game"),r.a.createElement("p",null,"The object of the same is to find sets of three cards that are either the same or different along each of four dimensions."),r.a.createElement("p",null,"If that makes perfect sense to you, then go ahead and start playing. Otherwise, I will explain a bit more."),r.a.createElement("p",null,"The game starts by laying out a board with twelve cards. Here are some example cards: "),r.a.createElement("div",{className:"row"},["0000","1210","0022","2101","0120","2011"].map((function(e,t){return r.a.createElement(Ie,{key:t,desc:e})}))),r.a.createElement("p",null,"You'll notice that every card has four different characteristics:"),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color"),r.a.createElement("li",null,"number"),r.a.createElement("li",null,"shape"),r.a.createElement("li",null,"fill")),r.a.createElement("p",null,"and each of those characteristics has three different possibilities."),r.a.createElement("p",null,"Three cards form a set if, for each of those four characteristics, the three cards are either ",r.a.createElement("em",null,"all the same")," or ",r.a.createElement("em",null,"all different.")),r.a.createElement("p",null,"It is easier to understand with examples, so here is an example set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"0112"})))," ",r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"1111"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"2110"})))),r.a.createElement("p",null,"Which you can describe as follows:"),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - SAME"),r.a.createElement("li",null,"shape - SAME"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - DIFFERENT")),r.a.createElement("p",null,"Therefore, the three cards form a set."),r.a.createElement("p",null,"Here is another set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"2022"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"1112"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"0202"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - SAME")),r.a.createElement("p",null,"This is not a set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"1220"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"1110"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"2000"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"fill - SAME"),r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - NOT THE SAME OR DIFFERENT!")),r.a.createElement("p",null,"Even though the cards have the same fill, different colors, and different shapes, the numbers are neither ",r.a.createElement("em",null,"all the same")," nor ",r.a.createElement("em",null,"all different"),", so it's not a set."),r.a.createElement("p",null,"It doesn't matter how many of the characteristics are the same, and how many are different, as long as for ",r.a.createElement("em",null,"each")," characteristic, the cards are all the same or all different. Here's one last example:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"1122"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"0201"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(Q,{desc:"2010"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - DIFFERENT")),r.a.createElement("p",null,"Each characteristic is different for all three cards, so this is a set."),r.a.createElement("p",null,r.a.createElement(s.b,{to:"/"},"Back Home")))};var Re=function(e){var t=Object(E.d)((function(e){return e.user}));return Object(n.useEffect)((function(){T.auth().getRedirectResult().then((function(e){if(e.credential)var t=e.credential.accessToken;var a=e.user;console.log(t,a)})).catch((function(e){e.code,e.message,e.email,e.credential}))}),[]),t?r.a.createElement("div",{className:"container"},r.a.createElement(C,null)):r.a.createElement("div",{className:"container"},r.a.createElement("button",{onClick:_,className:"btn"},"Sign in"))},Me={declareTime:5e3,colors:ce,playingTo:6,cpuDelay:1200},Pe=function(){var e=G();return Object(f.a)({},B({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Ge=function(e){for(var t={},a=0;a<e;a++)t[a]={score:0,color:Me.colors[a]};return t},Ae={numPlayers:null,players:Ge(2),gameStarted:!1,name:"1",setFound:!1,declarer:null,timeDeclared:null,gameOver:"",difficulty:2,cpuTurnInterval:1e3,cpuFound:[]},Ue=function(e){Object(W.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(L.a)(this,a),(n=t.call(this,e)).handleStartGame=function(e){n.setState({numPlayers:e,players:Ge(e)}),n.setState({gameStarted:!0})},n.updatePlayerScore=function(e,t){var a=n.state.players,r=a[e].score+t;return[y()(a,Object(m.a)({},e,{$merge:{score:r}})),r]},n.expireDeclare=function(){var e=n.state,t=e.declarer,a=e.selected;if(!A(a)){var r=n.updatePlayerScore(t,-.5),c=Object(o.a)(r,1)[0];n.setState({players:c,declarer:null,timeDeclared:null,selected:[]})}},n.markPointForDeclarer=function(e){var t=n.updatePlayerScore(e,1),a=Object(o.a)(t,2),r={players:a[0],gameOver:a[1]>=Me.playingTo?e:""};n.setState(r)},n.performDeclare=function(e){if(!n.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};n.setState(t),n.undeclareID=setTimeout((function(){n.expireDeclare()}),Me.declareTime)}},n.updateSelected=function(e,t){var a={setFound:A(e),selected:e,declarer:t};a.setFound&&(clearTimeout(n.undeclareID),setTimeout((function(){n.removeSet()}),2e3)),n.setState(a)},n.handleCardClick=function(e){var t=n.state,a=t.setFound,r=t.declarer;if(!a&&null!==r){var c=U(e,n.state.selected);n.setState({selected:c}),A(c)&&n.updateSelected(c,r)}},n.handlePlayerClick=function(e){null===n.state.declarer&&n.performDeclare(e)},n.handleRedeal=function(){var e=B(n.state);n.setState(e)},n.removeSet=function(){var e=n.state,t=e.declarer,a=e.selected;if(A(a)){console.log("Set found, removing");var r=n.markPointForDeclarer(t),c=Object(f.a)({},r,{setFound:!1,declarer:null,timeDeclared:null},V(n.state));n.setState(c)}clearInterval(n.cpuTimer),setTimeout((function(){n.cpuTimer=setInterval(n.cpuTurn,n.state.cpuTurnInterval)}),Me.cpuDelay)},n.resetGame=function(){clearInterval(n.cpuTimer),n.setState(Object(f.a)({},Object(I.cloneDeep)(Ae),{},Pe()))},n.state=Object(f.a)({},Object(I.cloneDeep)(Ae),{},Pe()),n}return Object(H.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,n=t.deck,c=t.selected,l=t.declarer,o=t.players,i=t.numPlayers;t.setFound;return console.log(o),i?r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{board:a,deck:n,selected:c,declarer:l,handleCardClick:this.handleCardClick,handlePlayerClick:this.handlePlayerClick,handleDeclare:this.handleDeclare,players:o,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,sharedDevice:!0,gameMode:"shared-device"})):r.a.createElement("div",{className:"container"},r.a.createElement("h4",{className:"mb-4"},"Choose Number of Players"),r.a.createElement("div",{className:"row text-center"},Object(x.a)(Array(6).keys()).map((function(t){return r.a.createElement("div",{key:"players-".concat(t),onClick:function(){e.handleStartGame(t+1)},className:"mb-3 col-4"},r.a.createElement("button",{className:"btn btn-info"},t+1))}))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(s.b,{to:"/solo"},"Back"))))}}]),a}(n.Component);var Be=function(e){var t=Object(E.d)((function(e){return e.user})),a=t.user,c=Object(n.useState)(null),l=Object(o.a)(c,2),i=l[0],m=l[1];return Object(E.c)(),Object(n.useEffect)((function(){var e=function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:he.a.get("/api/user/stats/".concat(a.uid)).then((function(e){m(e.data)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.loading||null===a||e()}),[t.loading]),t.loading?"Loading...":null===a?r.a.createElement("div",{className:"container mt-4"},r.a.createElement("p",null,"Sign in to view stats"),r.a.createElement("p",null,r.a.createElement("button",{onClick:_,className:"btn btn-info"},"Sign in"))):r.a.createElement("div",{className:"container mt-2 mt-md-4"},r.a.createElement("h3",null,"Statistics"),r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Difficulty"),r.a.createElement("th",null,"Games Played"),r.a.createElement("th",null,"Winning Percentage"))),r.a.createElement("tbody",null,i&&i.map((function(e,t){return r.a.createElement("tr",{key:"stats-".concat(t)},r.a.createElement("td",null,e.difficulty_level),r.a.createElement("td",null,e.games_played),r.a.createElement("td",null,Math.round(e.games_won/e.games_played*100),"%"))})))),r.a.createElement("p",null,r.a.createElement(s.b,{to:"/"},"Main Menu")))},Ve=a(70),_e=a.n(Ve),ze=function(e){var t=e.children,a=e.visible;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{show:a},r.a.createElement(oe.a.Header,null,r.a.createElement(oe.a.Title,null,"Submitting action...")),r.a.createElement(oe.a.Body,null,t),r.a.createElement(oe.a.Footer,null)))},Le=4e3,He=1200,We=function(e){var t=function(e){return Math.round((e-3)/3)}(e),a=G();return Object(f.a)({},B({deck:a},{boardSize:e,minimumSets:t}),{selected:[]})},Ke={players:{you:{score:0,color:ce[0]}},gameStarted:!1,name:"you",setFound:!1,gameOver:!1,startTime:null,elapsedTime:null,setsFound:[],setsOnBoard:null,cardsOnBoard:12,popupVisible:!1,popUpText:"SET!"},$e=function(e){Object(W.a)(a,e);var t=Object(K.a)(a);function a(e){var n;return Object(L.a)(this,a),(n=t.call(this,e)).handleStartGame=function(e){e.preventDefault();var t=n.state.cardsOnBoard,a=We(t),r=new Date;n.setState(Object(f.a)({gameStarted:!0,startTime:r,elapsedTime:0},a,{setsOnBoard:P(a.board)})),window.timeId=setInterval((function(){var e=Math.round(((new Date).getTime()-r.getTime())/1e3);n.setState({elapsedTime:e})}),1e3)},n.componentDidMount=function(){},n.updatePlayerScore=function(e,t){var a=n.state.players,r=a[e].score+t;return[y()(a,Object(m.a)({},e,{$merge:{score:r}})),r]},n.performDeclare=function(e){if(!n.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};n.setState(t),n.undeclareID=setTimeout((function(){n.expireDeclare()}),Le)}},n.updateSelected=function(e,t){var a={setFound:A(e),selected:e,declarer:t};a.setFound&&(clearTimeout(n.undeclareID),setTimeout((function(){n.removeSet()}),2e3)),n.setState(a)},n.handleDeclare=function(){},n.resetLocalSelected=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.setState((function(t){if(3===t.selected.length&&(e||!A(t.selected)))return{selected:[]}}))},n.handleCardClick=function(e){var t=U(e,n.state.selected);3===t.length&&(A(t)?(console.log("Set found"),n.setState((function(e){window.setTimeout((function(){n.setState({popupVisible:!1}),n.resetLocalSelected(!0)}),2e3);var a=e.setsFound;return a.map((function(e){return!Object(I.isEqual)(t.sort(),e)})).every((function(e){return e}))?{setsFound:[].concat(Object(x.a)(a),[t.sort()]),popupVisible:!0,popUpText:"SET!"}:{popupVisible:!0,popUpText:"Already found!"}}))):(console.log("Bad set selected!"),window.setTimeout(n.resetLocalSelected,1200))),n.setState(Object(f.a)({},{},{selected:t}))},n.handleRedeal=function(){},n.removeSet=function(){var e=n.state,t=e.declarer,a=e.selected;if(A(a)){console.log("Set found, removing");var r=n.markPointForDeclarer(t),c=Object(f.a)({},r,{setFound:!1,declarer:null,timeDeclared:null},V(n.state));n.setState(c)}clearInterval(n.cpuTimer),setTimeout((function(){n.cpuTimer=setInterval(n.cpuTurn,n.state.cpuTurnInterval)}),He)},n.resetGame=function(){clearInterval(n.cpuTimer),n.setState(Object(f.a)({},Object(I.cloneDeep)(Ke),{},We()))},n.state=Object(f.a)({},Object(I.cloneDeep)(Ke)),n}return Object(H.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,c=t.deck,l=t.selected,o=t.declarer,i=t.players,m=t.gameStarted,u=(t.setFound,t.setsFound),d=t.popupVisible,p=this.props.userReducer,f=p.user;return p.loading?"Loading...":m?r.a.createElement(r.a.Fragment,null,r.a.createElement(ze,{visible:d},r.a.createElement("p",{className:"flow-text center-align"},this.state.popUpText)),r.a.createElement(ie,{board:a,deck:c,selected:l,declarer:o,handleCardClick:this.handleCardClick,handleDeclare:this.handleDeclare,players:i,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,gameMode:"puzzle",setsFound:u,startTime:this.state.startTime,elapsedTime:this.state.elapsedTime})):r.a.createElement("div",{className:"container"},null!==f&&r.a.createElement(C,null),r.a.createElement("h3",null,"Puzzle Mode"),r.a.createElement("p",null,"Find as many sets as you can"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 m4"},r.a.createElement(_e.a,{ref:function(t){e.difficultyInput=t},min:2,max:4,orientation:"horizontal",tooltip:!0,format:function(e){return 3*e},value:Number(this.state.cardsOnBoard)/3,onChange:function(t){e.setState({cardsOnBoard:3*t})}}),r.a.createElement("form",{onSubmit:this.handleStartGame},r.a.createElement("input",{type:"submit",value:"Start",className:"btn"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{style:{marginTop:"48px"},className:"col s12"},r.a.createElement("p",{style:{marginTop:"36px"}},r.a.createElement(s.b,{to:"/solo"},"Back to Solo Menu")),!f&&r.a.createElement(n.Fragment,null,r.a.createElement("hr",null),r.a.createElement("p",null,"To save your stats, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:_,className:"btn"},"Sign in")))))))}}]),a}(n.Component),Je=Object(E.b)((function(e){return{userReducer:e.user}}))($e);class Ye extends n.Component{render(){return r.a.createElement(n.Fragment,null,r.a.createElement(s.a,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/",component:Ce}),r.a.createElement(i.a,{path:"/host",component:de}),r.a.createElement(i.a,{path:"/lobby",component:Ee}),r.a.createElement(i.a,{path:"/guest/:gameName",component:fe}),r.a.createElement(i.a,{path:"/solo",component:Fe}),r.a.createElement(i.a,{path:"/local",component:Ue}),r.a.createElement(i.a,{path:"/rules",component:xe}),r.a.createElement(i.a,{path:"/login",component:Re}),r.a.createElement(i.a,{path:"/stats",component:Be}),r.a.createElement(i.a,{path:"/puzzle",component:Je}))))}}var qe=Ye;var Xe=function(e){const t=Object(n.useState)(null),a=Object(o.a)(t,2),c=(a[0],a[1],Object(E.c)());return Object(n.useEffect)(()=>{k.a.auth().onAuthStateChanged(e=>{if(e){const t=window.localStorage.getItem("nickname")||e.displayName.split(" ")[0],a={displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,photoURL:e.photoURL,isAnonymous:e.isAnonymous,uid:e.uid,providerData:e.providerData,nickname:t};c(N({loading:!1,user:a})),he.a.get("/api/user/".concat(e.uid)).then(e=>{console.log("User is registered")}).catch(t=>{t.response&&404===t.response.status?(console.log("User not registered"),he.a.post("/api/user",{uid:e.uid,info:a}).then(()=>{console.log("User registered successfully")}).catch(e=>{console.log("Error registering user",e)})):console.log("An error occurred trying to GET user info")})}else console.log("Not signed in"),c(N({loading:!1,user:null}))})},[]),r.a.createElement(qe,null)};l.a.render(r.a.createElement(E.a,{store:w},r.a.createElement(Xe,null)),document.getElementById("root"))},65:function(e,t,a){e.exports=a.p+"static/media/sad_trombone.baad2ca9.mp3"},66:function(e,t,a){e.exports=a.p+"static/media/applause.c2030d5b.mp3"},71:function(e,t,a){e.exports=a(127)},76:function(e,t,a){},88:function(e,t,a){}},[[71,1,2]]]);
//# sourceMappingURL=main.07043d12.chunk.js.map