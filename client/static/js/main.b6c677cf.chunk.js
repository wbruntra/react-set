(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{119:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),c=a(19),r=a.n(c),s=(a(68),a(6)),o=a(5),i=a(24),m=a(28),d=a.n(m),u=a(34),h=a(2),p=a(9),E=a(26),g=a(54),b=a(55),f=a(20),v=a.n(f);const y=e=>({type:"UPDATE_USER",payload:e}),N=e=>({type:"UPDATE_NICKNAME",payload:e}),O={loading:!0,user:{}},S={user:(e=O,t)=>{switch(t.type){case"UPDATE_USER":return Object(h.a)({},e,{},t.payload);case"UPDATE_NICKNAME":return v()(e,{user:{nickname:{$set:t.payload}}});case"LOGOUT":return{loading:!1,user:null};default:return e}}};var w=Object(E.createStore)(Object(E.combineReducers)(S),Object(b.composeWithDevTools)(Object(E.applyMiddleware)(g.a))),j=a(10),T=a.n(j);a(27),a(31);var k={apiKey:"AIzaSyCLA_RFXrPvBdN_vrApCUlj28a82ownuzg",authDomain:"fire-set.firebaseapp.com",databaseURL:"https://fire-set.firebaseio.com",projectId:"fire-set",storageBucket:"fire-set.appspot.com",messagingSenderId:"958559518798",appId:"1:958559518798:web:ec451bbfb4ac03f30ec31f",measurementId:"G-FCHHM3FEZE"};j.initializeApp(k);var F=j.firestore();var D=function(){const e=Object(p.c)(),t=Object(i.f)();return n.a.createElement("div",{className:"my-3",style:{cursor:"pointer"}},n.a.createElement("p",{className:"text-right text-white"},n.a.createElement("a",{className:"btn btn-danger",onClick:()=>{T.a.auth().signOut().then(()=>{e({type:"LOGOUT"}),console.log("Signed out."),t.push("/")})}},"Sign Out")))},C=a(3);const x=e=>[...Array(e).keys()],I=(e,t=3)=>{let a;a=4===t?x(3).map(t=>x(4).map(a=>e.includes(4*t+a)?"x":"o").join("")):x(4).map(t=>x(3).map(a=>e.includes(3*t+a)?"x":"o").join("")),console.log(a.join("\n"))},R=(e,{debug:t=!1,returnWhenFound:a=!1}={})=>{let l=0,n=[];for(let c=0;c<e.length-2;c++)for(let r=c+1;r<e.length-1;r++)for(let s=r+1;s<e.length;s++)if(n=[e[c],e[r],e[s]],M(n)&&(t&&I([c,r,s]),l++,a))return l;return l},G=()=>{let e=[];return x(3).forEach(t=>{x(3).forEach(a=>{x(3).forEach(l=>{x(3).forEach(n=>{const c=""+t+l+a+n;e.push(c)})})})}),e},M=e=>{if(3!==e.length)return!1;const t=Object(s.a)(e,3),a=t[0],l=t[1],n=t[2];for(let c=0;c<4;c++){if((Number(a[c])+Number(l[c])+Number(n[c]))%3!==0)return!1}return!0},P=(e,t)=>t.includes(e)?t.filter(t=>t!==e):[...t,e],A=({board:e=[],deck:t},a=12,l=1)=>{let n=Object(C.shuffle)([...e,...t]);for(;R(n.slice(0,a))<l&&R(n,{returnWhenFound:!0})>0;)n=Object(C.shuffle)(n);return{deck:n.slice(a),board:n.slice(0,a)}},U=e=>{const t=e.board,a=e.deck,l=e.selected,n=a.slice(0,3);let c=[...t],r=a.slice(3);for(l.forEach((e,t)=>{let a=c.indexOf(e);c[a]=n[t]});0===R(c);){var s=A({board:c,deck:r});r=s.deck,c=s.board}return{deck:r,board:c,selected:[]}},B=()=>{const e=new j.auth.GoogleAuthProvider;j.auth().signInWithRedirect(e)},V=(e,t)=>{let a;a="string"===typeof e?F.collection("games").doc(e):e,a.update(Object(h.a)({},t,{lastUpdate:j.firestore.FieldValue.serverTimestamp()}))};a(80);const _=120,z=200,L=4,H=25,W=({fill:e,color:t})=>{let a=L;return n.a.createElement("svg",{width:"120",height:"200",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("g",null,n.a.createElement("rect",{fill:"#fff",id:"canvas_background",height:"202",width:"122",y:"-1",x:"-1"}),n.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},n.a.createElement("rect",{fill:"#fff",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),n.a.createElement("g",null,n.a.createElement("path",{stroke:t,transform:" rotate(270,58.8,98) scale(0.8 1) translate(10 0) ",id:"svg_5",d:" m-17.49,66 c50.83,-35.45 101.7,35.45 152.5,0 c30,-10 30,43.8 0,63.8 c-50.8,35.45 -101.6,-35.45 -152.5,0 c-30,15 -30,-45 0,-63.59 z ",fillOpacity:"null",strokeOpacity:"null",strokeWidth:a,fill:e})))},K=({shape:e,fill:t,color:a})=>{let l=H,c=z,r=_;return"0"===e?(l+=1,n.a.createElement(W,{fill:t,color:a})):"1"===e?n.a.createElement("g",null,n.a.createElement("ellipse",{stroke:a,ry:(c-2*l)/2,rx:(r-2*l)/2,cy:c/2,cx:r/2,fillOpacity:"null",strokeOpacity:"null",strokeWidth:L,fill:t})):"2"===e?n.a.createElement("g",null,n.a.createElement("polygon",{points:"".concat(l,",").concat(c/2,"\n          ").concat(r/2,",").concat(l,"\n          ").concat(r-l,",").concat(c/2,"\n          ").concat(r/2,",").concat(c-l),style:{fill:t,stroke:a,strokeWidth:L}})):void 0};class $ extends l.Component{constructor(...e){super(...e),this.colors={0:"#00A91D",1:"#311b92",2:"#FF0000",white:"#fff"},this.getFill=(e,t)=>"1"===t?"url(#card-".concat(e,"-").concat(t,")"):"2"===t?this.colors[e]:this.colors.white,this.drawShape=()=>{const e=this.props.desc.split(""),t=Object(s.a)(e,4),a=t[1],c=t[2],r=t[3];return n.a.createElement(l.Fragment,null,n.a.createElement("g",null,n.a.createElement("title",null,"background"),n.a.createElement("rect",{fill:this.colors.white,id:"canvas_background",y:"-1",x:"-1"}),n.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},n.a.createElement("rect",{strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),n.a.createElement(K,{shape:c,fill:this.getFill(a,r),color:this.colors[a]}))}}render(){const e=this.props.desc.split(""),t=Object(s.a)(e,4),a=t[0],l=t[1],c=t[3];return n.a.createElement("div",{className:"game-card"},n.a.createElement("svg",{width:"0",height:"0"},n.a.createElement("pattern",{id:"card-".concat(l,"-").concat(c),width:10,height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse"},n.a.createElement("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:this.colors[l],strokeWidth:"5"}}))),x(Number(a)+1).map(e=>n.a.createElement("svg",{key:e,className:"shape",viewBox:"0 0 ".concat(_," ").concat(z),xmlns:"http://www.w3.org/2000/svg"},this.drawShape())))}}var J=$,Y=a(57),q=a.n(Y),X=a(58),Z=a.n(X);var Q=function(e){const t=e.gameOver,a=e.myName,l=e.solo,c=Object(p.d)(e=>e.user).user;return n.a.createElement("div",{className:"game-over container mt-5"},(()=>{const e=t===a?Z.a:q.a;return n.a.createElement("audio",{src:e,autoPlay:!0})})(),n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col col-md-6"},n.a.createElement("div",{className:"card shadow"},n.a.createElement("h3",{className:"text-center mt-3"},"GAME OVER!"),n.a.createElement("p",{className:"text-center mb-4"},"Winner: ",t," "),n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-4"},n.a.createElement("p",{className:"text-center"},n.a.createElement(o.b,{to:"/"},"Main"))),l&&null!==c&&n.a.createElement("div",{className:"col-4"},n.a.createElement("p",{className:"text-center"},n.a.createElement(o.b,{to:"/stats"},"Stats"))))))))};const ee=["light-blue","pink","amber","light-green","purple","orange"];var te=function({gameMode:e,deck:t,board:a,declarer:l,setsFound:c,startTime:r,elapsedTime:s}){const o=R(a);switch(e){case"shared-device":return null;case"versus":return n.a.createElement("div",{className:"topbar py-2 bg-".concat(l?"light":"dark","-orange")},n.a.createElement("nav",{className:"container text-white"},n.a.createElement("div",{className:"row justify-content-between text-center"},n.a.createElement("div",{className:"col"},"Sets: ",o),n.a.createElement("div",{className:"col"},l&&n.a.createElement(n.a.Fragment,null,"SET! ",l)))));case"puzzle":return n.a.createElement("div",{className:"navbar-fixed"},n.a.createElement("nav",null,n.a.createElement("div",{className:"nav-wrapper",style:{display:"flex",justifyContent:"space-between"}},n.a.createElement("div",null,"Total Sets: ",o),n.a.createElement("div",null,"Remaining: ",o-c.length),n.a.createElement("div",null,"Time: ",(e=>{const t=Math.floor(e/60),a=e-60*t;return"".concat(t,":").concat((e=>("00"+e).slice(-"00".length))(a))})(s)))));default:return null}},ae=a(13);function le({players:e,declarer:t,handlePlayerClick:a}){return n.a.createElement("div",{className:"row my-4 text-center justify-content-between"},e.map(e=>n.a.createElement("div",{className:"col-2 bg-".concat(e.color," ").concat(e.name==t?"active-player":""),onClick:()=>{a(e.name)},key:e.name},n.a.createElement("p",{className:"my-2 align-middle"},e.name==t?"SET!":e.score))))}var ne=function(e){const t=Object(l.useState)(null),a=Object(s.a)(t,2),c=(a[0],a[1]),r=Object(l.useState)(window.innerHeight),o=Object(s.a)(r,2),i=(o[0],o[1]),m=e.board,d=e.selected,u=(e.deck,e.declarer),p=e.players,E=e.gameOver,g=e.myName,b=e.setFound,f=e.sharedDevice,v=e.solo,y=e.gameMode,N=e.cpuGuessCounter;Object(l.useEffect)(()=>{const e=Object(C.debounce)(()=>{i(window.innerHeight)},150);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),Object(l.useEffect)(()=>{c(R(m,{debug:!1}))},[m]);const O=(({declarer:e,players:t})=>e?Object(C.get)(t,"".concat(e,".color"),""):Object(C.get)(t,"".concat(g,".color"),""))(e);if(!Object(C.isEmpty)(E))return n.a.createElement(Q,{gameOver:E,myName:g,solo:v});const S=Object(C.map)(p,(e,t)=>Object(h.a)({name:t},e)),w=Math.ceil(S.length/2),j=S.slice(0,w),T=S.slice(w);return n.a.createElement(l.Fragment,null,(Object(C.isEmpty)(p)||!Object.keys(p).includes(g))&&n.a.createElement(ae.a,{show:!0},n.a.createElement(ae.a.Header,null,n.a.createElement(ae.a.Title,null,"Waiting to join...")),n.a.createElement(ae.a.Body,null,n.a.createElement("h4",null,"Players:"),n.a.createElement("ul",{className:"collection"},Object(C.map)(p,(e,t)=>n.a.createElement("li",{key:t,className:"collection-item"},n.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)")))))),n.a.createElement(te,e),n.a.createElement("div",{className:"container"},f&&n.a.createElement(le,{players:j,declarer:u,handlePlayerClick:e.handlePlayerClick}),n.a.createElement("div",{className:"board"},n.a.createElement("div",{className:"row"},m.map(t=>n.a.createElement("div",{key:t,className:"card-column col-4",onClick:()=>{e.handleCardClick(t)}},n.a.createElement("div",{className:"card-holder ".concat(d.includes(t)?"bg-".concat(O):"")},n.a.createElement("div",{className:"card ".concat(b&&3===d.length&&!d.includes(t)?"blurry":"")},n.a.createElement(J,{desc:t})))))),!f&&"puzzle"!==y&&n.a.createElement("div",{className:"row text-center my-3"},Object(C.map)(p,(e,t)=>n.a.createElement("div",{key:t,className:"col s4 m3"},n.a.createElement("span",{className:"player-name bg-".concat(e.color," ").concat("cpu"===t?"cpu-name":""," ").concat(N%2===0?"off":"")},t,": ",e.score)))),f&&n.a.createElement(le,{players:T,declarer:u,handlePlayerClick:e.handlePlayerClick}),e.handleRedeal&&n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col mt-3 mt-md-4"},n.a.createElement("button",{onClick:e.handleRedeal,className:"btn btn-primary"},"Shuffle"))))))};var ce=function({isHost:e,players:t,setState:a}){return Object(C.findKey)(t,e=>e.host),n.a.createElement("div",{className:"container mt-4"},n.a.createElement("h4",null,"Players:"),n.a.createElement("ul",{className:"collection"},Object(C.map)(t,(e,t)=>n.a.createElement("li",{key:t,className:"collection-item"},n.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)")))),e?n.a.createElement("button",{className:"btn btn-primary",onClick:()=>{a({gameStarted:!0})}},"Start Game"):n.a.createElement("p",null,"Waiting for host to start game..."))};const re={turnTime:5e3,colors:ee,playingTo:6};var se=function(){const e=Object(p.d)(e=>e.user),t=e.user,a=e.loading,c=Object(p.c)(),r=Object(l.useRef)({}).current,i=G(),m=Object(h.a)({},A({deck:i.slice(12),board:i.slice(0,12)}),{selected:[]}),E=Object(l.useState)(),g=Object(s.a)(E,2),b=g[0],f=g[1],y=Object(l.useState)(""),O=Object(s.a)(y,2),S=O[0],w=O[1],j=Object(l.useState)(),k=Object(s.a)(j,2),x=k[0],I=k[1],R=Object(l.useState)(),_=Object(s.a)(R,2),z=_[0],L=(_[1],Object(l.useState)()),H=Object(s.a)(L,2),W=H[0],K=H[1],$=Object(l.useState)(Object(h.a)({gameTitle:"",players:{},created:!1,gameStarted:!1,myName:"",setFound:!1,declarer:null,gameOver:""},m)),J=Object(s.a)($,2),Y=J[0],q=J[1],X=Object(l.useRef)(Y);X.current=Y,Object(l.useEffect)(()=>{t&&!Object(C.isEmpty)(t.uid)&&F.collection("games").where("creator_uid","==",t.uid).get().then((function(e){e.forEach((function(e){console.log(e.id);const t=Object(h.a)({},e.data(),{gameTitle:e.id});console.log("Old game: ",t),f(t)}))})).catch((function(e){console.log("Error getting documents: ",e)}))},[t]),Object(l.useEffect)(()=>()=>{W&&W(),z&&z()},[z,W]),Object(l.useEffect)(()=>function(){window.clearInterval(x)},[x]);const Z=e=>{q(Object(h.a)({},X.current,{},e))},Q=()=>{const e=b.gameTitle;F.collection("games").doc(e).delete().then(()=>{console.log("Deleted old game"),f(void 0)})},ee=e=>{let t;t="string"===typeof e?F.collection("games").doc(e):e;const a=t.collection("actions");return console.log(a),a.onSnapshot(e=>{console.log("got action snapshot"),e.docChanges().forEach(e=>{if("added"===e.type){const t=e.doc.data();console.log(t),se(t),a.doc(e.doc.id).delete()}"removed"===e.type&&console.log("Removed action: ",e.doc.data())})}),a},te=function(){var e=Object(u.a)(d.a.mark((function e(t){var a,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.game=F.collection("games").doc(t),a=window.setInterval(()=>{V(r.game,{})},3e4),I(a),l=ee(r.game),K(l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=e=>{e.preventDefault();const a=Y.myName,l=Y.board,n=Y.deck,c=Y.selected,s=Y.players,o=Y.gameOver,i=Object(C.isEmpty)(S)?"".concat(a,"'s game"):S;Z({gameTitle:i}),r.game=F.collection("games").doc(i),r.game.set({creator_uid:t.uid,players:s,board:l,deck:n,selected:c,gameOver:o,lastUpdate:T.a.firestore.FieldValue.serverTimestamp()});const m=window.setInterval(()=>{r.game.update({lastUpdate:T.a.firestore.FieldValue.serverTimestamp()})},3e4);I(m),r.actions=ee(i),console.log(r.actions),Z({created:!0})},le=e=>{e.preventDefault(),Z({myName:t.nickname,players:{[t.nickname]:{host:!0,uid:t.uid,score:0,color:re.colors[0]}}})},se=e=>{const t=e.type,a=e.payload,l=X.current,n=l.players,c=l.declarer,r=l.board;switch(t){case"join":if(Object.keys(n).includes(a.name))return;const e=Object(h.a)({},n,{[a.name]:{host:!1,uid:a.uid,score:0,color:re.colors[Object.keys(n).length]}});ie({players:e});break;case"found":!c&&me(r,a.selected)&&de(a.selected,a.name);break;default:return}},oe=(e,t)=>{if(M(e)){const e=(e=>{if(!e)return{};const t=X.current.players,a=t[e].score+1,l=v()(t,{[e]:{$merge:{score:a}}}),n=a>=re.playingTo?e:"";return n&&window.setTimeout(()=>{r.game.delete(),clearInterval(x)},3e3),{players:l,gameOver:n}})(t),a=Object(h.a)({},X.current,{setFound:!1,declarer:null},e,{},U(X.current));ie(a)}},ie=e=>{console.log("updating",X.current.gameTitle),Z(e),V(r.game,e)},me=(e,t)=>{for(let a=0;a<t.length;a++)if(!e.includes(t[a]))return!1;return!0},de=(e,t)=>{const a={setFound:M(e),selected:e,declarer:t};ie(a),a.setFound&&setTimeout(()=>{oe(e,t)},4e3)},ue=Y.board,he=Y.deck,pe=Y.selected,Ee=Y.declarer,ge=Y.players,be=Y.created,fe=Y.gameStarted,ve=Y.myName;return a?"Loading...":Object(C.isEmpty)(t)?n.a.createElement("div",{className:"container mt-4"},n.a.createElement("p",null,"To host a game, sign in with your Google account."),n.a.createElement("p",null,n.a.createElement("button",{onClick:B,className:"btn btn-info"},"Sign in"))):b&&!Y.created?n.a.createElement("div",{className:"container"},n.a.createElement("p",null,"You are already hosting a game. Return to it?"),n.a.createElement("button",{className:"btn btn-primary mr-5",onClick:()=>(()=>{const e=Object(C.findKey)(b.players,e=>e.host),t=b.gameTitle;Z({gameTitle:t}),te(t),Z(Object(h.a)({myName:e,created:!0},b,{lastUpdate:T.a.firestore.FieldValue.serverTimestamp()}))})()},"YES!"),n.a.createElement("button",{className:"btn btn-danger",onClick:Q},"No, remove it")):""===ve?n.a.createElement("div",{className:"container"},n.a.createElement(D,null),n.a.createElement("h4",null,"Enter your nickname:"),n.a.createElement("form",{onSubmit:le},n.a.createElement("div",{className:"row mb-4"},n.a.createElement("div",{className:"col-md-3 mb-3 mr-md-4"},n.a.createElement("input",{autoFocus:!0,placeholder:"hostname",value:t.nickname,onChange:e=>{c(N(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}})),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit")))),n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement(o.b,{to:"/"},"Main Menu")))):be?fe?n.a.createElement(ne,{board:ue,deck:he,selected:pe,declarer:Ee,handleCardClick:e=>{const t=Y.myName;if(!Y.declarer){const a=P(e,Y.selected);M(a)&&de(a,t),Z({selected:a})}},handleRedeal:()=>{const e=A(Y);ie(e)},players:ge,setFound:Y.setFound,gameOver:Y.gameOver,myName:Y.myName,gameMode:"versus"}):n.a.createElement(ce,{isHost:!0,players:ge,setState:ie}):n.a.createElement("div",{className:"container mt-4"},n.a.createElement("h4",null,"Name your game:"),n.a.createElement("form",{onSubmit:ae},n.a.createElement("div",{className:"mb-3"},n.a.createElement("input",{autoFocus:!0,placeholder:"".concat(ve,"'s game"),onChange:e=>{w(e.target.value)},value:S})),n.a.createElement("div",null,n.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create"))))},oe=a(60);var ie=function(e){const t=Object(p.d)(e=>e.user),a=t.user,c=(t.loading,Object(p.c)()),r=Object(l.useState)({popupVisible:!1,setFound:!1,displayAnimation:!1,animatedSet:[],declarer:"",deck:[],board:[],selected:[],pending:null,gameStarted:!1}),i=Object(s.a)(r,2),m=i[0],d=i[1],u=Object(l.useState)(""),E=Object(s.a)(u,2),g=E[0],b=E[1],f=Object(l.useState)(),v=Object(s.a)(f,2),y=(v[0],v[1],Object(l.useRef)({}).current),O=Object(l.useRef)(m);O.current=m;const S=e=>{d(Object(h.a)({},O.current,{},e))},w=()=>{const e=O.current,t=e.declarer,a=e.selected;Object(C.isEmpty)(t)&&3===a.length&&!M(a)&&S({selected:[]})},j=e=>{e.preventDefault();const t=a.nickname;if(Object(C.isEmpty)(t))return;b(t);const l={type:"join",payload:{name:t,uid:a.uid}};k(l)},k=e=>{console.log("Creating on",y.actions),y.actions.add(Object(h.a)({},e,{created:T.a.firestore.FieldValue.serverTimestamp()})).then((function(t){if("found"===e.type){const e=t.id;console.log("Document written with ID: ",e),S({pending:e})}}))};Object(l.useEffect)(()=>{const t=e.match.params.gameName;y.game=F.collection("games").doc(t);const a=y.game.onSnapshot(e=>{(e=>{const t=Object(h.a)({},e.data()),a=O.current.selected;if(Object(C.isEmpty)(t))return;console.log("Updating",t);const l=a.length<3&&Object(C.isEmpty)(t.declarer)?a:t.selected;console.log("New selected",l),S(Object(h.a)({},t,{selected:l,popupVisible:!1}))})(e)});y.actions=y.game.collection("actions");const l=y.actions.onSnapshot(e=>{e.docChanges().forEach(e=>{if("removed"===e.type){O.current.pending===e.doc.id&&(console.log("Pending action removed!"),S({pending:null}))}})});return function(){y.game&&a(),y.actions&&l()}},[]);const x=m.board,I=m.deck,R=m.selected,G=m.declarer,A=m.players,U=m.popupVisible;if(t.loading)return"Loading profile...";if(Object(C.isEmpty)(a))return n.a.createElement("div",{className:"container"},n.a.createElement("p",null,"To join a game, sign in with your Google account."),n.a.createElement("p",null,n.a.createElement("button",{onClick:B,className:"btn btn-info"},"Sign in")),n.a.createElement("p",null,n.a.createElement(o.b,{to:"/lobby"},"Back")));if(!g)return n.a.createElement("div",{className:"container"},n.a.createElement(D,null),n.a.createElement("h4",{className:"mb-3"},"Choose your nickname:"),n.a.createElement("form",{onSubmit:j},n.a.createElement("div",{className:"col-12 col-md-4"},n.a.createElement("input",{autoFocus:!0,type:"text",placeholder:"your name",value:a.nickname,onChange:e=>{c(N(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}})),n.a.createElement("div",{className:"col-12 col-md-4"},n.a.createElement("input",{className:"btn btn-primary mt-3 ml-md-3",type:"submit",value:"Join"}))));const V=O.current,_=V.setFound,z=V.gameOver;return V.gameStarted?n.a.createElement(n.a.Fragment,null,n.a.createElement(ae.a,{show:m.pending&&U},n.a.createElement(ae.a.Header,null,n.a.createElement(ae.a.Title,null,"Submitting action...")),n.a.createElement(ae.a.Body,null,n.a.createElement("p",{className:"text-center"},"SET!"),n.a.createElement("div",{className:"text-center"},n.a.createElement(oe.a,{animation:"border"})))),n.a.createElement(ne,{board:x,deck:I,selected:R,declarer:G,handleCardClick:e=>{const t=O.current,a=t.declarer,l=t.selected;if(a)return;const n=P(e,l);if(n.length>3)return;const c={};if(3===n.length)if(M(n)){const e={type:"found",payload:{selected:n,name:g}};console.log("Found set, sending..."),k(e),c.popupVisible=!0}else console.log("Bad set selected!"),window.setTimeout(w,1e3);S(Object(h.a)({},c,{selected:n}))},players:A,setFound:_,gameOver:z,myName:g,gameMode:"versus"})):n.a.createElement(ce,{players:A,isHost:!1})};class me extends l.Component{constructor(e){super(e),this.componentWillUnmount=()=>{this.unsubscribe()};this.state={name:"",newGame:"baz",init:!1,games:[]}}componentDidMount(){this.gamesRef=F.collection("games"),this.unsubscribe=this.gamesRef.onSnapshot(e=>{const t=[];e.forEach(e=>{t.push(Object(h.a)({name:e.id},e.data()))}),this.setState({init:!0,games:t})})}render(){const e=this.state,t=e.games,a=e.init;if(console.log(t),!a)return null;const c=t.filter(e=>{const t=e.lastUpdate;if(!t)return!1;const a=t.toMillis(),l=(new Date).getTime();return Math.round((l-a)/1e3)<40});return n.a.createElement("div",{className:"container",style:{height:"100vh"}},0===c.length?n.a.createElement(l.Fragment,null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-8 col-md-6"},n.a.createElement("div",{className:"card-panel teal",style:{marginTop:.2*window.innerHeight}},n.a.createElement("span",{className:"white-text"},"There are currently no active games.")),n.a.createElement("p",null,"Click ",n.a.createElement(o.b,{to:"/host"},"here")," to host one"),n.a.createElement("p",null,n.a.createElement(o.b,{className:"btn btn-primary",to:"/"},"Back"))))):n.a.createElement(l.Fragment,null,n.a.createElement("h4",{className:"text-center my-4"},"Available games"),n.a.createElement("div",{className:"row align-content-center"},c.map((e,t)=>n.a.createElement("div",{className:"col-6 col-md-4",key:e.name},n.a.createElement("div",{className:"card available-game"},n.a.createElement("div",{className:"my-auto text-center"},n.a.createElement(o.b,{to:"/guest/".concat(e.name)},e.name)))))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col mt-4"},n.a.createElement(o.b,{className:"btn btn-primary",to:"/"},"Back")))))}}var de=me,ue=a(23),he=a.n(ue),pe=a(61),Ee=a.n(pe);const ge=4e3,be=ee,fe=6,ve=1200,ye=e=>{let t=Number(e);return Number.isNaN(t)&&(t=1),24e3/(5*t)},Ne=()=>{const e=G();return Object(h.a)({},A({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Oe={players:{you:{score:0,color:be[0]},cpu:{score:0,color:be[1]}},gameStarted:!1,myName:"you",setFound:!1,declarer:null,gameOver:null,cpuTurnInterval:1e3,startTime:new Date,cpuGuessCounter:0};class Se extends l.Component{constructor(e){super(e),this.handleStartGame=e=>{e.preventDefault(),this.setState({gameStarted:!0,startTime:new Date}),console.log("Turns every ".concat(this.state.cpuTurnInterval," ms")),setTimeout(()=>{const e=window.setInterval(this.cpuTurn,this.state.cpuTurnInterval);this.setState({cpuTimer:e})},ve)},this.componentDidMount=()=>{const e=window.localStorage.getItem("soloDifficulty");let t=e?Number(e):2;const a=ye(t);this.setState({difficulty:t,cpuTurnInterval:a})},this.componentWillUnmount=()=>{null!==this.state.cpuTimer&&window.clearInterval(this.state.cpuTimer)},this.cpuTurn=()=>{const e=this.state,t=e.board,a=e.declarer,l=e.gameOver;if(a||l)return;this.setState(e=>({cpuGuessCounter:e.cpuGuessCounter+1}));const n=Object(C.shuffle)(t).slice(0,2),c=Object(s.a)(n,2),r=c[0],o=c[1],i=((e,t)=>{let a,l,n="";for(let c=0;c<4;c++)e[c]===t[c]?n+=e[c]:(a=Number(e[c])+Number(t[c]),l=(3-a).toString(),n+=l);return n.trim()})(r,o);t.includes(i)&&(this.setState({declarer:"cpu",selected:[r],cpuFound:[o,i],setFound:!0}),null!==this.state.cpuTimer&&clearInterval(this.state.cpuTimer),this.setState({cpuAnimation:window.setInterval(this.animateCpuChoice,900)}))},this.animateCpuChoice=()=>{const e=this.state,t=e.selected,a=[...e.cpuFound];if(0===a.length)return;const l=[...t,a.pop()];this.setState({cpuFound:a,selected:l}),3===l.length&&(null!==this.state.cpuAnimation&&clearInterval(this.state.cpuAnimation),this.updateSelected(l,"cpu"))},this.updatePlayerScore=(e,t)=>{const a=this.state.players,l=a[e].score+t;return[v()(a,{[e]:{$merge:{score:l}}}),l]},this.expireDeclare=()=>{const e=this.state,t=e.declarer,a=e.selected;if(t&&!M(a)){const e=this.updatePlayerScore(t,-.5),a=Object(s.a)(e,1)[0];this.setState({players:a,declarer:null,timeDeclared:void 0,selected:[]})}},this.markPointForDeclarer=e=>{const t=this.updatePlayerScore(e,1),a=Object(s.a)(t,2),l=a[0],n=a[1],c=this.props.userReducer.user,r=n>=fe?e:"",o={players:l,gameOver:r};if(!Object(C.isEmpty)(r)){const t=c&&c.uid||"anonymous",a="you"==e?1:0,l=Math.round(((new Date).getTime()-this.state.startTime.getTime())/1e3);he.a.post("/api/game",{uid:t,total_time:l,player_won:a,difficulty_level:this.state.difficulty,winning_score:n}).then(()=>{console.log("Game sent")}).catch(e=>{console.log("Error sending game")})}return this.setState(o),o},this.performDeclare=e=>{if(!this.state.declarer){const t={declarer:e,timeDeclared:(new Date).getTime()};this.setState(t),this.setState({undeclareId:window.setTimeout(()=>{this.expireDeclare()},ge)})}},this.updateSelected=(e,t)=>{const a={setFound:M(e),selected:e,declarer:t};a.setFound&&(this.state.undeclareId&&clearTimeout(this.state.undeclareId),setTimeout(()=>{this.removeSet()},2e3)),this.setState(a)},this.handleCardClick=e=>{const t=this.state,a=t.setFound,l=t.declarer,n=t.myName;if(!a&&"cpu"!==l){const t=P(e,this.state.selected);l||this.performDeclare(n),this.setState({selected:t}),M(t)&&this.updateSelected(t,"you")}},this.handleRedeal=()=>{if(!this.state.declarer){const e=A(this.state);this.setState(e)}},this.removeSet=()=>{const e=this.state,t=e.declarer,a=e.selected;if(t&&M(a)){console.log("Set found, removing"),this.markPointForDeclarer(t);const e=Object(h.a)({setFound:!1,declarer:null,timeDeclared:void 0},U(this.state));this.setState(e)}this.state.cpuTimer&&clearInterval(this.state.cpuTimer),setTimeout(()=>{const e=window.setInterval(this.cpuTurn,this.state.cpuTurnInterval);this.setState({cpuTimer:e})},ve)},this.resetGame=()=>{this.state.cpuTimer&&window.clearInterval(this.state.cpuTimer),this.setState(Object(h.a)({},Object(C.cloneDeep)(Oe),{},Ne()))},this.state=Object(h.a)({},Object(C.cloneDeep)(Oe),{},Ne(),{difficulty:2})}render(){const e=this.state,t=e.board,a=e.deck,l=e.selected,c=e.declarer,r=e.players,s=e.gameStarted,i=(e.setFound,this.props.userReducer),m=i.user;return i.loading?"Loading...":s?n.a.createElement(n.a.Fragment,null,n.a.createElement(ne,{board:t,deck:a,selected:l,declarer:c,handleCardClick:this.handleCardClick,handleDeclare:()=>{},handleRedeal:this.handleRedeal,players:r,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.myName,resetGame:this.resetGame,solo:!0,gameMode:"versus",cpuGuessCounter:this.state.cpuGuessCounter})):n.a.createElement("div",{className:"container main-content"},null!==m&&n.a.createElement(D,null),n.a.createElement("h3",{className:"text-center mb-4"},"Solo Play vs. Computer"),n.a.createElement("h4",{className:"mb-4"},"Choose difficulty level:"),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12"},n.a.createElement("form",{onSubmit:this.handleStartGame},n.a.createElement("div",{className:"col-10 col-md-6 mb-5"},n.a.createElement(Ee.a,{maxValue:6,minValue:1,value:this.state.difficulty,onChange:e=>{const t=ye(e);window.localStorage.setItem("soloDifficulty",e.toString()),this.setState({cpuTurnInterval:t,difficulty:e})}})),n.a.createElement("input",{type:"submit",value:"Start",className:"btn btn-primary"})),n.a.createElement("p",{style:{marginTop:"24px"}},"First to ",fe," points is the winner")),n.a.createElement("div",{className:"row mt-4"},n.a.createElement("ul",{style:{listStyleType:"none"}},n.a.createElement("li",{className:"mb-4"},n.a.createElement(o.b,{to:"/local"},"Local Multiplayer")),n.a.createElement("li",null,n.a.createElement(o.b,{to:"/"},"Back to Main Menu"))))),!m&&n.a.createElement("div",{className:"row mt-4"},n.a.createElement("div",null,n.a.createElement("p",null,"To save your game statistics, sign in with your Google account."),n.a.createElement("p",null,n.a.createElement("button",{onClick:B,className:"btn btn-info"},"Sign in")))))}}var we=Object(p.b)(e=>({userReducer:e.user}))(Se);function je(e){const t=e.url,a=e.cardName,l=e.description;return n.a.createElement("div",{className:"col-9 col-md-4"},n.a.createElement(o.b,{to:t},n.a.createElement("div",{className:"card shadow-sm mb-3 mb-md-4"},n.a.createElement(J,{desc:a}))),n.a.createElement("p",{className:"text-center"},l))}var Te=function(){return n.a.createElement("div",{className:"container mt-3 mt-md-5"},n.a.createElement("h1",{className:"d-none d-md-block text-center mb-3 mb-md-5"},"Main Menu"),n.a.createElement("div",{className:"row justify-content-center"},[{url:"/solo",cardName:"0012",description:"Solo/Local"},{url:"/lobby",cardName:"1121",description:"Join Game"},{url:"/host",cardName:"2200",description:"Host Game"}].map((e,t)=>n.a.createElement(je,Object.assign({key:"card-".concat(t)},e)))),n.a.createElement("div",{className:"d-none d-md-block"},n.a.createElement("hr",null),n.a.createElement("p",null,n.a.createElement(o.b,{to:"/rules"},"Rules")),n.a.createElement("p",null,n.a.createElement(o.b,{to:"/stats"},"View Statistics"))))};function ke({desc:e}){return n.a.createElement("div",{className:"col-4 my-2"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:e})))}var Fe=function(){return n.a.createElement("div",{className:"rules container"},n.a.createElement("h2",null,"Rules of the Game"),n.a.createElement("p",null,"The object of the same is to find sets of three cards that are either the same or different along each of four dimensions."),n.a.createElement("p",null,"If that makes perfect sense to you, then go ahead and start playing. Otherwise, I will explain a bit more."),n.a.createElement("p",null,"The game starts by laying out a board with twelve cards. Here are some example cards: "),n.a.createElement("div",{className:"row"},["0000","1210","0022","2101","0120","2011"].map((e,t)=>n.a.createElement(ke,{key:t,desc:e}))),n.a.createElement("p",null,"You'll notice that every card has four different characteristics:"),n.a.createElement("ul",{className:"browser-default"},n.a.createElement("li",null,"color"),n.a.createElement("li",null,"number"),n.a.createElement("li",null,"shape"),n.a.createElement("li",null,"fill")),n.a.createElement("p",null,"and each of those characteristics has three different possibilities."),n.a.createElement("p",null,"Three cards form a set if, for each of those four characteristics, the three cards are either ",n.a.createElement("em",null,"all the same")," or ",n.a.createElement("em",null,"all different.")),n.a.createElement("p",null,"It is easier to understand with examples, so here is an example set:"),n.a.createElement("div",{className:"row my-3"},n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"0112"})))," ",n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"1111"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"2110"})))),n.a.createElement("p",null,"Which you can describe as follows:"),n.a.createElement("ul",{className:"browser-default"},n.a.createElement("li",null,"color - SAME"),n.a.createElement("li",null,"shape - SAME"),n.a.createElement("li",null,"number - DIFFERENT"),n.a.createElement("li",null,"fill - DIFFERENT")),n.a.createElement("p",null,"Therefore, the three cards form a set."),n.a.createElement("p",null,"Here is another set:"),n.a.createElement("div",{className:"row my-3"},n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"2022"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"1112"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"0202"})))),n.a.createElement("ul",{className:"browser-default"},n.a.createElement("li",null,"color - DIFFERENT"),n.a.createElement("li",null,"shape - DIFFERENT"),n.a.createElement("li",null,"number - DIFFERENT"),n.a.createElement("li",null,"fill - SAME")),n.a.createElement("p",null,"This is not a set:"),n.a.createElement("div",{className:"row my-3"},n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"1220"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"1110"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"2000"})))),n.a.createElement("ul",{className:"browser-default"},n.a.createElement("li",null,"fill - SAME"),n.a.createElement("li",null,"color - DIFFERENT"),n.a.createElement("li",null,"shape - DIFFERENT"),n.a.createElement("li",null,"number - NOT THE SAME OR DIFFERENT!")),n.a.createElement("p",null,"Even though the cards have the same fill, different colors, and different shapes, the numbers are neither ",n.a.createElement("em",null,"all the same")," nor ",n.a.createElement("em",null,"all different"),", so it's not a set."),n.a.createElement("p",null,"It doesn't matter how many of the characteristics are the same, and how many are different, as long as for ",n.a.createElement("em",null,"each")," characteristic, the cards are all the same or all different. Here's one last example:"),n.a.createElement("div",{className:"row my-3"},n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"1122"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"0201"}))),n.a.createElement("div",{className:"col-4"},n.a.createElement("div",{className:"card"},n.a.createElement(J,{desc:"2010"})))),n.a.createElement("ul",{className:"browser-default"},n.a.createElement("li",null,"color - DIFFERENT"),n.a.createElement("li",null,"shape - DIFFERENT"),n.a.createElement("li",null,"number - DIFFERENT"),n.a.createElement("li",null,"fill - DIFFERENT")),n.a.createElement("p",null,"Each characteristic is different for all three cards, so this is a set."),n.a.createElement("p",null,n.a.createElement(o.b,{to:"/"},"Back Home")))};var De=function(e){const t=Object(p.d)(e=>e.user);return Object(l.useEffect)(()=>{j.auth().getRedirectResult().then((function(e){if(e.credential)var t=e.credential.accessToken;var a=e.user;console.log(t,a)})).catch((function(e){e.code,e.message,e.email,e.credential}))},[]),t?n.a.createElement("div",{className:"container"},n.a.createElement(D,null)):n.a.createElement("div",{className:"container"},n.a.createElement("button",{onClick:B,className:"btn"},"Sign in"))};const Ce={declareTime:5e3,colors:ee,playingTo:6,cpuDelay:1200},xe=()=>{const e=G();return Object(h.a)({},A({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Ie=e=>{const t={};for(let a=0;a<e;a++)t[a]={score:0,color:Ce.colors[a]};return t},Re={numPlayers:null,players:Ie(2),gameStarted:!1,name:"1",setFound:!1,declarer:null,timeDeclared:null,gameOver:"",difficulty:2,cpuTurnInterval:1e3,cpuFound:[]};class Ge extends l.Component{constructor(e){super(e),this.handleStartGame=e=>{this.setState({numPlayers:e,players:Ie(e)}),this.setState({gameStarted:!0})},this.updatePlayerScore=(e,t)=>{const a=this.state.players,l=a[e].score+t;return[v()(a,{[e]:{$merge:{score:l}}}),l]},this.expireDeclare=()=>{const e=this.state,t=e.declarer,a=e.selected;if(!M(a)){const e=this.updatePlayerScore(t,-.5),a=Object(s.a)(e,1)[0];this.setState({players:a,declarer:null,timeDeclared:null,selected:[]})}},this.markPointForDeclarer=e=>{const t=this.updatePlayerScore(e,1),a=Object(s.a)(t,2),l={players:a[0],gameOver:a[1]>=Ce.playingTo?e:""};this.setState(l)},this.performDeclare=e=>{if(!this.state.declarer){const t={declarer:e,timeDeclared:(new Date).getTime()};this.setState(t),this.undeclareID=setTimeout(()=>{this.expireDeclare()},Ce.declareTime)}},this.updateSelected=(e,t)=>{const a={setFound:M(e),selected:e,declarer:t};a.setFound&&(clearTimeout(this.undeclareID),setTimeout(()=>{this.removeSet()},2e3)),this.setState(a)},this.handleCardClick=e=>{const t=this.state,a=t.setFound,l=t.declarer;if(!a&&null!==l){const t=P(e,this.state.selected);this.setState({selected:t}),M(t)&&this.updateSelected(t,l)}},this.handlePlayerClick=e=>{null===this.state.declarer&&this.performDeclare(e)},this.handleRedeal=()=>{const e=A(this.state);this.setState(e)},this.removeSet=()=>{const e=this.state,t=e.declarer,a=e.selected;if(M(a)){console.log("Set found, removing");const e=this.markPointForDeclarer(t),a=Object(h.a)({},e,{setFound:!1,declarer:null,timeDeclared:null},U(this.state));this.setState(a)}clearInterval(this.cpuTimer),setTimeout(()=>{this.cpuTimer=setInterval(this.cpuTurn,this.state.cpuTurnInterval)},Ce.cpuDelay)},this.resetGame=()=>{clearInterval(this.cpuTimer),this.setState(Object(h.a)({},Object(C.cloneDeep)(Re),{},xe()))},this.state=Object(h.a)({},Object(C.cloneDeep)(Re),{},xe())}render(){const e=this.state,t=e.board,a=e.deck,l=e.selected,c=e.declarer,r=e.players,s=e.numPlayers;e.setFound;return console.log(r),s?n.a.createElement(n.a.Fragment,null,n.a.createElement(ne,{board:t,deck:a,selected:l,declarer:c,handleCardClick:this.handleCardClick,handlePlayerClick:this.handlePlayerClick,handleDeclare:this.handleDeclare,players:r,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,sharedDevice:!0,gameMode:"shared-device"})):n.a.createElement("div",{className:"container"},n.a.createElement("h4",{className:"mb-4"},"Choose Number of Players"),n.a.createElement("div",{className:"row text-center"},[...Array(6).keys()].map(e=>n.a.createElement("div",{key:"players-".concat(e),onClick:()=>{this.handleStartGame(e+1)},className:"mb-3 col-4"},n.a.createElement("button",{className:"btn btn-info"},e+1)))),n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement(o.b,{to:"/solo"},"Back"))))}}var Me=Ge;var Pe=function(e){const t=Object(p.d)(e=>e.user),a=t.user,c=Object(l.useState)(null),r=Object(s.a)(c,2),i=r[0],m=r[1];return Object(p.c)(),Object(l.useEffect)(()=>{const e=function(){var e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:he.a.get("/api/user/stats/".concat(a.uid)).then(e=>{m(e.data)});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.loading||null===a||e()},[t.loading]),t.loading?"Loading...":null===a?n.a.createElement("div",{className:"container mt-4"},n.a.createElement("p",null,"Sign in to view stats"),n.a.createElement("p",null,n.a.createElement("button",{onClick:B,className:"btn btn-info"},"Sign in"))):n.a.createElement("div",{className:"container mt-2 mt-md-4"},n.a.createElement("h3",null,"Statistics"),n.a.createElement("table",{className:"table table-striped"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Difficulty"),n.a.createElement("th",null,"Games Played"),n.a.createElement("th",null,"Winning Percentage"))),n.a.createElement("tbody",null,i&&i.map((e,t)=>n.a.createElement("tr",{key:"stats-".concat(t)},n.a.createElement("td",null,e.difficulty_level),n.a.createElement("td",null,e.games_played),n.a.createElement("td",null,Math.round(e.games_won/e.games_played*100),"%"))))),n.a.createElement("p",null,n.a.createElement(o.b,{to:"/"},"Main Menu")))},Ae=a(62),Ue=a.n(Ae);var Be=({children:e,visible:t})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(ae.a,{show:t},n.a.createElement(ae.a.Header,null,n.a.createElement(ae.a.Title,null,"Submitting action...")),n.a.createElement(ae.a.Body,null,e),n.a.createElement(ae.a.Footer,null)));const Ve=4e3,_e=1200,ze=e=>{const t=(e=>Math.round((e-3)/3))(e),a=G();return Object(h.a)({},A({deck:a},{boardSize:e,minimumSets:t}),{selected:[]})},Le={players:{you:{score:0,color:ee[0]}},gameStarted:!1,name:"you",setFound:!1,gameOver:!1,startTime:null,elapsedTime:null,setsFound:[],setsOnBoard:null,cardsOnBoard:12,popupVisible:!1,popUpText:"SET!"};class He extends l.Component{constructor(e){super(e),this.handleStartGame=e=>{e.preventDefault();const t=this.state.cardsOnBoard,a=ze(t),l=new Date;this.setState(Object(h.a)({gameStarted:!0,startTime:l,elapsedTime:0},a,{setsOnBoard:R(a.board)})),window.timeId=setInterval(()=>{const e=Math.round(((new Date).getTime()-l.getTime())/1e3);this.setState({elapsedTime:e})},1e3)},this.componentDidMount=()=>{},this.updatePlayerScore=(e,t)=>{const a=this.state.players,l=a[e].score+t;return[v()(a,{[e]:{$merge:{score:l}}}),l]},this.performDeclare=e=>{if(!this.state.declarer){const t={declarer:e,timeDeclared:(new Date).getTime()};this.setState(t),this.undeclareID=setTimeout(()=>{this.expireDeclare()},Ve)}},this.updateSelected=(e,t)=>{const a={setFound:M(e),selected:e,declarer:t};a.setFound&&(clearTimeout(this.undeclareID),setTimeout(()=>{this.removeSet()},2e3)),this.setState(a)},this.handleDeclare=()=>{},this.resetLocalSelected=(e=!1)=>{this.setState(t=>{if(3===t.selected.length&&(e||!M(t.selected)))return{selected:[]}})},this.handleCardClick=e=>{const t=P(e,this.state.selected);3===t.length&&(M(t)?(console.log("Set found"),this.setState(e=>{window.setTimeout(()=>{this.setState({popupVisible:!1}),this.resetLocalSelected(!0)},2e3);const a=e.setsFound;return a.map(e=>!Object(C.isEqual)(t.sort(),e)).every(e=>e)?{setsFound:[...a,t.sort()],popupVisible:!0,popUpText:"SET!"}:{popupVisible:!0,popUpText:"Already found!"}})):(console.log("Bad set selected!"),window.setTimeout(this.resetLocalSelected,1200))),this.setState(Object(h.a)({},{},{selected:t}))},this.handleRedeal=()=>{},this.removeSet=()=>{const e=this.state,t=e.declarer,a=e.selected;if(M(a)){console.log("Set found, removing");const e=this.markPointForDeclarer(t),a=Object(h.a)({},e,{setFound:!1,declarer:null,timeDeclared:null},U(this.state));this.setState(a)}clearInterval(this.cpuTimer),setTimeout(()=>{this.cpuTimer=setInterval(this.cpuTurn,this.state.cpuTurnInterval)},_e)},this.resetGame=()=>{clearInterval(this.cpuTimer),this.setState(Object(h.a)({},Object(C.cloneDeep)(Le),{},ze()))},this.state=Object(h.a)({},Object(C.cloneDeep)(Le))}render(){const e=this.state,t=e.board,a=e.deck,c=e.selected,r=e.declarer,s=e.players,i=e.gameStarted,m=(e.setFound,e.setsFound),d=e.popupVisible,u=this.props.userReducer,h=u.user;return u.loading?"Loading...":i?n.a.createElement(n.a.Fragment,null,n.a.createElement(Be,{visible:d},n.a.createElement("p",{className:"flow-text center-align"},this.state.popUpText)),n.a.createElement(ne,{board:t,deck:a,selected:c,declarer:r,handleCardClick:this.handleCardClick,handleDeclare:this.handleDeclare,players:s,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,gameMode:"puzzle",setsFound:m,startTime:this.state.startTime,elapsedTime:this.state.elapsedTime})):n.a.createElement("div",{className:"container"},null!==h&&n.a.createElement(D,null),n.a.createElement("h3",null,"Puzzle Mode"),n.a.createElement("p",null,"Find as many sets as you can"),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s8 m4"},n.a.createElement(Ue.a,{ref:e=>{this.difficultyInput=e},min:2,max:4,orientation:"horizontal",tooltip:!0,format:e=>3*e,value:Number(this.state.cardsOnBoard)/3,onChange:e=>{this.setState({cardsOnBoard:3*e})}}),n.a.createElement("form",{onSubmit:this.handleStartGame},n.a.createElement("input",{type:"submit",value:"Start",className:"btn"}))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{style:{marginTop:"48px"},className:"col s12"},n.a.createElement("p",{style:{marginTop:"36px"}},n.a.createElement(o.b,{to:"/solo"},"Back to Solo Menu")),!h&&n.a.createElement(l.Fragment,null,n.a.createElement("hr",null),n.a.createElement("p",null,"To save your stats, sign in with your Google account."),n.a.createElement("p",null,n.a.createElement("button",{onClick:B,className:"btn"},"Sign in")))))))}}var We=Object(p.b)(e=>({userReducer:e.user}))(He);class Ke extends l.Component{render(){return n.a.createElement(l.Fragment,null,n.a.createElement(o.a,null,n.a.createElement(i.c,null,n.a.createElement(i.a,{exact:!0,path:"/",component:Te}),n.a.createElement(i.a,{path:"/host",component:se}),n.a.createElement(i.a,{path:"/lobby",component:de}),n.a.createElement(i.a,{path:"/guest/:gameName",component:ie}),n.a.createElement(i.a,{path:"/solo",component:we}),n.a.createElement(i.a,{path:"/local",component:Me}),n.a.createElement(i.a,{path:"/rules",component:Fe}),n.a.createElement(i.a,{path:"/login",component:De}),n.a.createElement(i.a,{path:"/stats",component:Pe}),n.a.createElement(i.a,{path:"/puzzle",component:We}))))}}var $e=Ke;var Je=function(e){const t=Object(l.useState)(null),a=Object(s.a)(t,2),c=(a[0],a[1],Object(p.c)());return Object(l.useEffect)(()=>{T.a.auth().onAuthStateChanged(e=>{if(e){const t=window.localStorage.getItem("nickname")||e.displayName.split(" ")[0],a={displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,photoURL:e.photoURL,isAnonymous:e.isAnonymous,uid:e.uid,providerData:e.providerData,nickname:t};c(y({loading:!1,user:a})),he.a.get("/api/user/".concat(e.uid)).then(e=>{console.log("User is registered")}).catch(t=>{t.response&&404===t.response.status?(console.log("User not registered"),he.a.post("/api/user",{uid:e.uid,info:a}).then(()=>{console.log("User registered successfully")}).catch(e=>{console.log("Error registering user",e)})):console.log("An error occurred trying to GET user info")})}else console.log("Not signed in"),c(y({loading:!1,user:null}))})},[]),n.a.createElement($e,null)};r.a.render(n.a.createElement(p.a,{store:w},n.a.createElement(Je,null)),document.getElementById("root"))},57:function(e,t,a){e.exports=a.p+"static/media/sad_trombone.baad2ca9.mp3"},58:function(e,t,a){e.exports=a.p+"static/media/applause.c2030d5b.mp3"},63:function(e,t,a){e.exports=a(119)},68:function(e,t,a){},80:function(e,t,a){}},[[63,1,2]]]);
//# sourceMappingURL=main.b6c677cf.chunk.js.map