(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{124:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),l=a.n(c),o=(a(74),a(5)),s=a(19),i=a(20),u=a(22),m=a(21),d=a(23),p=a(4),f=a(31),b=a(35),v=a.n(b),E=a(40),h=a(8),g=a(9),y=a(33),O=a(60),j=a(61),w=a(26),N=a.n(w);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=function(e){return{type:"UPDATE_USER",payload:e}},D=function(){return{type:"LOGOUT"}},P=function(e){return{type:"UPDATE_NICKNAME",payload:e}},F={loading:!0,user:{}},C={user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USER":return T({},e,{},t.payload);case"UPDATE_NICKNAME":var a=N()(e,{user:{nickname:{$set:t.payload}}});return a;case"LOGOUT":return{loading:!1,user:null};default:return e}}},I=Object(y.createStore)(Object(y.combineReducers)(C),Object(j.composeWithDevTools)(Object(y.applyMiddleware)(O.a))),x=a(10),R=a.n(x),M=(a(34),a(37),{apiKey:"AIzaSyCLA_RFXrPvBdN_vrApCUlj28a82ownuzg",authDomain:"fire-set.firebaseapp.com",databaseURL:"https://fire-set.firebaseio.com",projectId:"fire-set",storageBucket:"fire-set.appspot.com",messagingSenderId:"958559518798",appId:"1:958559518798:web:ec451bbfb4ac03f30ec31f",measurementId:"G-FCHHM3FEZE"});x.initializeApp(M);var G=x.firestore();var A=function(){var e=Object(g.c)(),t=Object(f.f)();return r.a.createElement("div",{className:"my-3",style:{cursor:"pointer"}},r.a.createElement("p",{className:"text-right text-white"},r.a.createElement("a",{className:"btn btn-danger",onClick:function(){R.a.auth().signOut().then((function(){e(D()),console.log("Signed out."),t.push("/")}))}},"Sign Out")))},U=a(2),B=a(17);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z=function(e){return Object(B.a)(Array(e).keys())},L=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;t=4===a?z(3).map((function(t){return z(4).map((function(a){return e.includes(4*t+a)?"x":"o"})).join("")})):z(4).map((function(t){return z(3).map((function(a){return e.includes(3*t+a)?"x":"o"})).join("")})),console.log(t.join("\n"))},H=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.debug,n=void 0!==a&&a,r=t.returnWhenFound,c=void 0!==r&&r,l=0,o=[],s=0;s<e.length-2;s++)for(var i=s+1;i<e.length-1;i++)for(var u=i+1;u<e.length;u++)if(o=[e[s],e[i],e[u]],K(o)&&(n&&L([s,i,u]),l++,c))return l;return l},W=function(){var e=[];return z(3).forEach((function(t){z(3).forEach((function(a){z(3).forEach((function(n){z(3).forEach((function(r){var c=""+t+n+a+r;e.push(c)}))}))}))})),e},K=function(e){if(3!==e.length)return!1;for(var t=Object(o.a)(e,3),a=t[0],n=t[1],r=t[2],c=0;c<4;c++){if((Number(a[c])+Number(n[c])+Number(r[c]))%3!==0)return!1}return!0},$=function(e,t){for(var a="",n=0;n<4;n++)e[n]===t[n]?a+=e[n]:a+=(3-(Number(e[n])+Number(t[n]))).toString();return a.trim()},J=function(e,t){return t.includes(e)?t.filter((function(t){return t!==e})):[].concat(Object(B.a)(t),[e])},Y=function(e){for(var t=e.board,a=void 0===t?[]:t,n=e.deck,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=Object(U.shuffle)([].concat(Object(B.a)(a),Object(B.a)(n)));H(l.slice(0,r))<c&&H(l,{returnWhenFound:!0})>0;)l=Object(U.shuffle)(l);return{deck:l.slice(r),board:l.slice(0,r)}},q=function(e){var t=e.board,a=e.deck,n=e.selected,r=a.slice(0,3),c=Object(B.a)(t),l=a.slice(3);for(n.forEach((function(e,t){var a=c.indexOf(e);c[a]=r[t]}));0===H(c);){var o=Y({board:c,deck:l});l=o.deck,c=o.board}return{deck:l,board:c,selected:[]}},X=function(){var e=new x.auth.GoogleAuthProvider;x.auth().signInWithRedirect(e)},Z=function(e,t){("string"===typeof e?G.collection("games").doc(e):e).update(_({},t,{lastUpdate:x.firestore.FieldValue.serverTimestamp()}))},Q=(a(85),120),ee=200,te=4,ae=25,ne=function(e){var t=e.fill,a=e.color,n=te;return r.a.createElement("svg",{width:"120",height:"200",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",null,r.a.createElement("rect",{fill:"#fff",id:"canvas_background",height:"202",width:"122",y:"-1",x:"-1"}),r.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},r.a.createElement("rect",{fill:"#fff",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),r.a.createElement("g",null,r.a.createElement("path",{stroke:a,transform:" rotate(270,58.8,98) scale(0.8 1) translate(10 0) ",id:"svg_5",d:" m-17.49,66 c50.83,-35.45 101.7,35.45 152.5,0 c30,-10 30,43.8 0,63.8 c-50.8,35.45 -101.6,-35.45 -152.5,0 c-30,15 -30,-45 0,-63.59 z ",fillOpacity:"null",strokeOpacity:"null",strokeWidth:n,fill:t})))},re=function(e){var t=e.shape,a=e.fill,n=e.color,c=ae,l=ee,o=Q;return"0"===t?(c+=1,r.a.createElement(ne,{fill:a,color:n})):"1"===t?r.a.createElement("g",null,r.a.createElement("ellipse",{stroke:n,ry:(l-2*c)/2,rx:(o-2*c)/2,cy:l/2,cx:o/2,fillOpacity:"null",strokeOpacity:"null",strokeWidth:te,fill:a})):"2"===t?r.a.createElement("g",null,r.a.createElement("polygon",{points:"".concat(c,",").concat(l/2,"\n          ").concat(o/2,",").concat(c,"\n          ").concat(o-c,",").concat(l/2,"\n          ").concat(o/2,",").concat(l-c),style:{fill:a,stroke:n,strokeWidth:te}})):void 0},ce=function(e){function t(){var e,a;Object(s.a)(this,t);for(var c=arguments.length,l=new Array(c),i=0;i<c;i++)l[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(l)))).colors={0:"#00A91D",1:"#311b92",2:"#FF0000",white:"#fff"},a.getFill=function(e,t){return"1"===t?"url(#card-".concat(e,"-").concat(t,")"):"2"===t?a.colors[e]:a.colors.white},a.drawShape=function(){var e=a.props.desc.split(""),t=Object(o.a)(e,4),c=t[1],l=t[2],s=t[3];return r.a.createElement(n.Fragment,null,r.a.createElement("g",null,r.a.createElement("title",null,"background"),r.a.createElement("rect",{fill:a.colors.white,id:"canvas_background",y:"-1",x:"-1"}),r.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},r.a.createElement("rect",{strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),r.a.createElement(re,{shape:l,fill:a.getFill(c,s),color:a.colors[c]}))},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.desc.split(""),a=Object(o.a)(t,4),n=a[0],c=a[1],l=a[3];return r.a.createElement("div",{className:"game-card"},r.a.createElement("svg",{width:"0",height:"0"},r.a.createElement("pattern",{id:"card-".concat(c,"-").concat(l),width:10,height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse"},r.a.createElement("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:this.colors[c],strokeWidth:"5"}}))),z(Number(n)+1).map((function(t){return r.a.createElement("svg",{key:t,className:"shape",viewBox:"0 0 ".concat(Q," ").concat(ee),xmlns:"http://www.w3.org/2000/svg"},e.drawShape())})))}}]),t}(n.Component),le=a(63),oe=a.n(le),se=a(64),ie=a.n(se);var ue=function(e){var t=e.gameOver,a=e.myName,n=e.solo,c=Object(g.d)((function(e){return e.user})).user;return r.a.createElement("div",{className:"game-over container mt-5"},function(){var e=t===a?ie.a:oe.a;return r.a.createElement("audio",{src:e,autoPlay:!0})}(),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-md-6"},r.a.createElement("div",{className:"card shadow"},r.a.createElement("h3",{className:"text-center mt-3"},"GAME OVER!"),r.a.createElement("p",{className:"text-center mb-4"},"Winner: ",t," "),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-4"},r.a.createElement("p",{className:"text-center"},r.a.createElement(p.b,{to:"/"},"Main"))),n&&null!==c&&r.a.createElement("div",{className:"col-4"},r.a.createElement("p",{className:"text-center"},r.a.createElement(p.b,{to:"/stats"},"Stats"))))))))},me=["light-blue","pink","amber","light-green","purple","orange"],de=function(e){var t=Math.floor(e/60),a=e-60*t;return"".concat(t,":").concat(function(e){return("00"+e).slice(-"00".length)}(a))};var pe=function(e){var t=e.gameMode,a=(e.deck,e.board),n=e.declarer,c=e.setsFound,l=(e.startTime,e.elapsedTime),o=H(a);switch(t){case"shared-device":return null;case"versus":return r.a.createElement("div",{className:"topbar py-2 bg-".concat(n?"light":"dark","-orange")},r.a.createElement("nav",{className:"container text-white"},r.a.createElement("div",{className:"row justify-content-between text-center"},r.a.createElement("div",{className:"col"},"Sets: ",o),r.a.createElement("div",{className:"col"},n&&r.a.createElement(r.a.Fragment,null,"SET! ",n)))));case"puzzle":return r.a.createElement("div",{className:"navbar-fixed"},r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper",style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,"Total Sets: ",o),r.a.createElement("div",null,"Remaining: ",o-c.length),r.a.createElement("div",null,"Time: ",de(l)))));default:return null}},fe=a(14);function be(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ve(e){var t=e.players,a=e.declarer,n=e.handlePlayerClick;return r.a.createElement("div",{className:"row my-4 text-center justify-content-between"},t.map((function(e){return r.a.createElement("div",{className:"col-2 bg-".concat(e.color," ").concat(e.name==a?"active-player":""),onClick:function(){n(e.name)},key:e.name},r.a.createElement("p",{className:"my-2 align-middle"},e.name==a?"SET!":e.score))})))}var Ee=function(e){var t=Object(n.useState)(null),a=Object(o.a)(t,2),c=(a[0],a[1]),l=Object(n.useState)(window.innerHeight),s=Object(o.a)(l,2),i=(s[0],s[1]),u=e.board,m=e.selected,d=(e.deck,e.declarer),p=e.players,f=e.gameOver,b=e.myName,v=e.setFound,E=e.sharedDevice,g=e.solo,y=e.gameMode;Object(n.useEffect)((function(){var e=Object(U.debounce)((function(){i(window.innerHeight)}),150);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(n.useEffect)((function(){c(H(u,{debug:!1}))}),[u]);var O=function(e){var t=e.declarer,a=e.players;return t?Object(U.get)(a,"".concat(t,".color"),""):Object(U.get)(a,"".concat(b,".color"),"")}(e);if(""!==f)return r.a.createElement(ue,{gameOver:f,myName:b,solo:g});var j=Object(U.map)(p,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?be(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):be(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({name:t},e)})),w=Math.ceil(j.length/2),N=j.slice(0,w),S=j.slice(w);return r.a.createElement(n.Fragment,null,(Object(U.isEmpty)(p)||!Object.keys(p).includes(b))&&r.a.createElement(fe.a,{show:!0},r.a.createElement(fe.a.Header,null,r.a.createElement(fe.a.Title,null,"Waiting to join...")),r.a.createElement(fe.a.Body,null,r.a.createElement("h4",null,"Players:"),r.a.createElement("ul",{className:"collection"},Object(U.map)(p,(function(e,t){return r.a.createElement("li",{key:t,className:"collection-item"},r.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)"))}))))),r.a.createElement(pe,e),r.a.createElement("div",{className:"container"},E&&r.a.createElement(ve,{players:N,declarer:d,handlePlayerClick:e.handlePlayerClick}),r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"row"},u.map((function(t){return r.a.createElement("div",{key:t,className:"card-column col-4",onClick:function(){e.handleCardClick(t)}},r.a.createElement("div",{className:"card-holder ".concat(m.includes(t)?"bg-".concat(O):"")},r.a.createElement("div",{className:"card ".concat(v&&3===m.length&&!m.includes(t)?"blurry":"")},r.a.createElement(ce,{desc:t}))))}))),!E&&"puzzle"!==y&&r.a.createElement("div",{className:"row text-center my-3"},Object(U.map)(p,(function(e,t){return r.a.createElement("div",{key:t,className:"col s4 m3"},r.a.createElement("span",{className:"player-name bg-".concat(e.color)},t,": ",e.score))}))),E&&r.a.createElement(ve,{players:S,declarer:d,handlePlayerClick:e.handlePlayerClick}),e.handleRedeal&&r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col mt-3 mt-md-4"},r.a.createElement("button",{onClick:e.handleRedeal,className:"btn btn-primary"},"Shuffle"))))))};var he=function(e){var t=e.isHost,a=e.players,n=e.setState;return Object(U.findKey)(a,(function(e){return e.host})),r.a.createElement("div",{className:"container mt-4"},r.a.createElement("h4",null,"Players:"),r.a.createElement("ul",{className:"collection"},Object(U.map)(a,(function(e,t){return r.a.createElement("li",{key:t,className:"collection-item"},r.a.createElement("span",{className:"player-name"},t," ",e.host&&"(host)"))}))),t?r.a.createElement("button",{className:"btn btn-primary",onClick:function(){n({gameStarted:!0})}},"Start Game"):r.a.createElement("p",null,"Waiting for host to start game..."))};function ge(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ye(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ge(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ge(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Oe={turnTime:5e3,colors:me,playingTo:6};var je=function(){var e=Object(g.d)((function(e){return e.user})),t=e.user,a=e.loading,c=Object(g.c)(),l=Object(n.useRef)({}).current,s=W(),i=ye({},Y({deck:s.slice(12),board:s.slice(0,12)}),{selected:[]}),u=Object(n.useState)(),m=Object(o.a)(u,2),d=m[0],f=m[1],b=Object(n.useState)(""),y=Object(o.a)(b,2),O=y[0],j=y[1],w=Object(n.useState)(),S=Object(o.a)(w,2),T=S[0],k=S[1],D=Object(n.useState)(),F=Object(o.a)(D,2),C=F[0],I=(F[1],Object(n.useState)()),x=Object(o.a)(I,2),M=x[0],B=x[1],V=Object(n.useState)(ye({gameTitle:"",players:{},created:!1,gameStarted:!1,myName:"",setFound:!1,declarer:null,gameOver:""},i)),_=Object(o.a)(V,2),z=_[0],L=_[1],H=Object(n.useRef)(z);H.current=z,Object(n.useEffect)((function(){t&&!Object(U.isEmpty)(t.uid)&&G.collection("games").where("creator_uid","==",t.uid).get().then((function(e){e.forEach((function(e){console.log(e.id);var t=ye({},e.data(),{gameTitle:e.id});console.log("Old game: ",t),f(t)}))})).catch((function(e){console.log("Error getting documents: ",e)}))}),[t]),Object(n.useEffect)((function(){return function(){M&&M(),C&&C()}}),[C,M]),Object(n.useEffect)((function(){return function(){window.clearInterval(T)}}),[T]);var $=function(e){L(ye({},H.current,{},e))},Q=function(e){var t=("string"===typeof e?G.collection("games").doc(e):e).collection("actions");return console.log(t),t.onSnapshot((function(e){console.log("got action snapshot"),e.docChanges().forEach((function(e){if("added"===e.type){var a=e.doc.data();console.log(a),te(a),t.doc(e.doc.id).delete()}"removed"===e.type&&console.log("Removed action: ",e.doc.data())}))})),t},ee=function(){var e=Object(E.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.game=G.collection("games").doc(t),a=window.setInterval((function(){Z(l.game,{})}),3e4),k(a),n=Q(l.game),B(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e){var t=e.type,a=e.payload,n=H.current,r=n.players,c=n.declarer,l=n.board;switch(t){case"join":if(Object.keys(r).includes(a.name))return;var o=ye({},r,Object(h.a)({},a.name,{host:!1,uid:a.uid,score:0,color:Oe.colors[Object.keys(r).length]}));ne({players:o});break;case"found":!c&&re(l,a.selected)&&ce(a.selected,a.name);break;default:return}},ae=function(e,t){if(K(e)){var a=function(e){if(!e)return{};var t=H.current.players,a=t[e].score+1,n=N()(t,Object(h.a)({},e,{$merge:{score:a}})),r=a>=Oe.playingTo?e:"";return r&&window.setTimeout((function(){l.game.delete(),clearInterval(T)}),3e3),{players:n,gameOver:r}}(t),n=ye({},H.current,{setFound:!1,declarer:null},a,{},q(H.current));ne(n)}},ne=function(e){console.log("updating",H.current.gameTitle),$(e),Z(l.game,e)},re=function(e,t){for(var a=0;a<t.length;a++)if(!e.includes(t[a]))return!1;return!0},ce=function(e,t){var a={setFound:K(e),selected:e,declarer:t};ne(a),a.setFound&&setTimeout((function(){ae(e,t)}),4e3)},le=z.board,oe=z.deck,se=z.selected,ie=z.declarer,ue=z.players,me=z.created,de=z.gameStarted,pe=z.myName;return a?"Loading...":Object(U.isEmpty)(t)?r.a.createElement("div",{className:"container mt-4"},r.a.createElement("p",null,"To host a game, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:X,className:"btn btn-info"},"Sign in"))):d&&!z.created?r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"You are already hosting a game. Return to it?"),r.a.createElement("button",{className:"btn btn-primary mr-5",onClick:function(){return function(){var e=Object(U.findKey)(d.players,(function(e){return e.host})),t=d.gameTitle;$({gameTitle:t}),ee(t),$(ye({myName:e,created:!0},d,{lastUpdate:R.a.firestore.FieldValue.serverTimestamp()}))}()}},"YES!"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(){var e=d.gameTitle;G.collection("games").doc(e).delete().then((function(){console.log("Deleted old game"),f(void 0)}))}},"No, remove it")):""===pe?r.a.createElement("div",{className:"container"},r.a.createElement(A,null),r.a.createElement("h4",null,"Enter your nickname:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),$({myName:t.nickname,players:Object(h.a)({},t.nickname,{host:!0,uid:t.uid,score:0,color:Oe.colors[0]})})}},r.a.createElement("div",{className:"row mb-4"},r.a.createElement("div",{className:"col-3 mr-4"},r.a.createElement("input",{autoFocus:!0,placeholder:"hostname",value:t.nickname,onChange:function(e){c(P(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}})),r.a.createElement("div",{className:"col-3"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit")))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(p.b,{to:"/"},"Main Menu")))):me?de?r.a.createElement(Ee,{board:le,deck:oe,selected:se,declarer:ie,handleCardClick:function(e){var t=z.myName;if(!z.declarer){var a=J(e,z.selected);K(a)&&ce(a,t),$({selected:a})}},handleRedeal:function(){var e=Y(z);ne(e)},players:ue,setFound:z.setFound,gameOver:z.gameOver,myName:z.myName,gameMode:"versus"}):r.a.createElement(he,{isHost:!0,players:ue,setState:ne}):r.a.createElement("div",{className:"container mt-4"},r.a.createElement("h4",null,"Name your game:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=z.myName,n=z.board,r=z.deck,c=z.selected,o=z.players,s=z.gameOver,i=Object(U.isEmpty)(O)?"".concat(a,"'s game"):O;$({gameTitle:i}),l.game=G.collection("games").doc(i),l.game.set({creator_uid:t.uid,players:o,board:n,deck:r,selected:c,gameOver:s,lastUpdate:R.a.firestore.FieldValue.serverTimestamp()});var u=window.setInterval((function(){l.game.update({lastUpdate:R.a.firestore.FieldValue.serverTimestamp()})}),3e4);k(u),l.actions=Q(i),console.log(l.actions),$({created:!0})}},r.a.createElement("div",{className:"mb-3"},r.a.createElement("input",{autoFocus:!0,placeholder:"".concat(pe,"'s game"),onChange:function(e){j(e.target.value)},value:O})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create"))))},we=a(66);function Ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ne(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ne(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Te=function(e){var t=Object(g.d)((function(e){return e.user})),a=t.user,c=(t.loading,Object(g.c)()),l=Object(n.useState)({popupVisible:!1,setFound:!1,displayAnimation:!1,animatedSet:[],declarer:"",deck:[],board:[],selected:[],pending:null,gameStarted:!1}),s=Object(o.a)(l,2),i=s[0],u=s[1],m=Object(n.useState)(""),d=Object(o.a)(m,2),f=d[0],b=d[1],v=Object(n.useState)(),E=Object(o.a)(v,2),h=(E[0],E[1],Object(n.useRef)({}).current),y=Object(n.useRef)(i);y.current=i;var O=function(e){u(Se({},y.current,{},e))},j=function(){var e=y.current,t=e.declarer,a=e.selected;Object(U.isEmpty)(t)&&3===a.length&&!K(a)&&O({selected:[]})},w=function(e){console.log("Creating on",h.actions),h.actions.add(Se({},e,{created:R.a.firestore.FieldValue.serverTimestamp()})).then((function(t){if("found"===e.type){var a=t.id;console.log("Document written with ID: ",a),O({pending:a})}}))};Object(n.useEffect)((function(){var t=e.match.params.gameName;h.game=G.collection("games").doc(t);var a=h.game.onSnapshot((function(e){!function(e){var t=Se({},e.data()),a=y.current.selected;if(!Object(U.isEmpty)(t)){console.log("Updating",t);var n=a.length<3&&Object(U.isEmpty)(t.declarer)?a:t.selected;console.log("New selected",n),O(Se({},t,{selected:n,popupVisible:!1}))}}(e)}));h.actions=h.game.collection("actions");var n=h.actions.onSnapshot((function(e){e.docChanges().forEach((function(e){"removed"===e.type&&(y.current.pending===e.doc.id&&(console.log("Pending action removed!"),O({pending:null})))}))}));return function(){h.game&&a(),h.actions&&n()}}),[]);var N=i.board,S=i.deck,T=i.selected,k=i.declarer,D=i.players,F=i.popupVisible;if(t.loading)return"Loading profile...";if(Object(U.isEmpty)(a))return r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"To join a game, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:X,className:"btn btn-info"},"Sign in")),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/lobby"},"Back")));if(!f)return r.a.createElement("div",{className:"container"},r.a.createElement(A,null),r.a.createElement("h4",null,"Choose nickname"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=a.nickname;if(!Object(U.isEmpty)(t)){b(t);var n={type:"join",payload:{name:t,uid:a.uid}};w(n)}}},r.a.createElement("input",{autoFocus:!0,type:"text",placeholder:"your name",value:a.nickname,onChange:function(e){c(P(e.target.value)),window.localStorage.setItem("nickname",e.target.value)}}),r.a.createElement("input",{className:"btn btn-primary ml-3",type:"submit",value:"Join"})));var C=y.current,I=C.setFound,x=C.gameOver;return C.gameStarted?r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{show:i.pending&&F},r.a.createElement(fe.a.Header,null,r.a.createElement(fe.a.Title,null,"Submitting action...")),r.a.createElement(fe.a.Body,null,r.a.createElement("p",{className:"text-center"},"SET!"),r.a.createElement("div",{className:"text-center"},r.a.createElement(we.a,{animation:"border"})))),r.a.createElement(Ee,{board:N,deck:S,selected:T,declarer:k,handleCardClick:function(e){var t=y.current,a=t.declarer,n=t.selected;if(!a){var r=J(e,n);if(!(r.length>3)){var c={};if(3===r.length)if(K(r)){var l={type:"found",payload:{selected:r,name:f}};console.log("Found set, sending..."),w(l),c.popupVisible=!0}else console.log("Bad set selected!"),window.setTimeout(j,1e3);O(Se({},c,{selected:r}))}}},players:D,setFound:I,gameOver:x,myName:f,gameMode:"versus"})):r.a.createElement(he,{players:D,isHost:!1})};function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var De=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).componentWillUnmount=function(){a.unsubscribe()};return a.state={name:"",newGame:"baz",init:!1,games:[]},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.gamesRef=G.collection("games"),this.unsubscribe=this.gamesRef.onSnapshot((function(t){var a=[];t.forEach((function(e){a.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({name:e.id},e.data()))})),e.setState({init:!0,games:a})}))}},{key:"render",value:function(){var e=this.state,t=e.games,a=e.init;if(console.log(t),!a)return null;var c=t.filter((function(e){var t=e.lastUpdate;if(!t)return!1;var a=t.toMillis(),n=(new Date).getTime();return Math.round((n-a)/1e3)<40}));return r.a.createElement("div",{className:"container",style:{height:"100vh"}},0===c.length?r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-8 col-md-6"},r.a.createElement("div",{className:"card-panel teal",style:{marginTop:.2*window.innerHeight}},r.a.createElement("span",{className:"white-text"},"There are currently no active games.")),r.a.createElement("p",null,"Click ",r.a.createElement(p.b,{to:"/host"},"here")," to host one"),r.a.createElement("p",null,r.a.createElement(p.b,{className:"btn btn-primary",to:"/"},"Back"))))):r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"center-align"},"Available games"),r.a.createElement("div",{className:"row center-align"},c.map((function(e,t){return r.a.createElement("div",{className:"col s6 m4",key:e.name},r.a.createElement(p.b,{to:"/guest/".concat(e.name)},r.a.createElement("div",{className:"card-panel"},e.name)))})),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/"},"Back")))))}}]),t}(n.Component),Pe=a(30),Fe=a.n(Pe),Ce=a(67),Ie=a.n(Ce);function xe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xe(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Me=!1,Ge={turnTime:4e3,colors:me,playingTo:6,cpuDelay:1200},Ae=function(e){var t=Number(e);return Number.isNaN(t)&&(t=1),24e3/(5*t)},Ue=function(){var e=W();return Re({},Y({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new Date,a=t.getTime()%Math.pow(10,6)/1e3;console.log(e,a.toFixed(1))},Ve={players:{you:{score:0,color:Ge.colors[0]},cpu:{score:0,color:Ge.colors[1]}},gameStarted:!1,myName:"you",setFound:!1,declarer:null,gameOver:null,cpuTurnInterval:1e3,startTime:new Date},_e=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleStartGame=function(e){e.preventDefault(),a.setState({gameStarted:!0,startTime:new Date}),console.log("Turns every ".concat(a.state.cpuTurnInterval," ms")),setTimeout((function(){var e=window.setInterval(a.cpuTurn,a.state.cpuTurnInterval);a.setState({cpuTimer:e})}),Ge.cpuDelay)},a.componentDidMount=function(){var e=window.localStorage.getItem("soloDifficulty"),t=e?Number(e):2,n=Ae(t);a.setState({difficulty:t,cpuTurnInterval:n})},a.componentWillUnmount=function(){null!==a.state.cpuTimer&&window.clearInterval(a.state.cpuTimer)},a.cpuTurn=function(){var e=a.state,t=e.board,n=e.declarer,r=e.gameOver;if(!n&&!r){Me&&Be("Guess");var c=Object(U.shuffle)(t).slice(0,2),l=Object(o.a)(c,2),s=l[0],i=l[1],u=$(s,i);t.includes(u)&&(a.setState({declarer:"cpu",selected:[s],cpuFound:[i,u],setFound:!0}),null!==a.state.cpuTimer&&clearInterval(a.state.cpuTimer),a.setState({cpuAnimation:window.setInterval(a.animateCpuChoice,900)}))}},a.animateCpuChoice=function(){var e=a.state,t=e.selected,n=e.cpuFound,r=Object(B.a)(n);if(0!==r.length){var c=[].concat(Object(B.a)(t),[r.pop()]);a.setState({cpuFound:r,selected:c}),3===c.length&&(null!==a.state.cpuAnimation&&clearInterval(a.state.cpuAnimation),a.updateSelected(c,"cpu"))}},a.updatePlayerScore=function(e,t){var n=a.state.players,r=n[e].score+t;return[N()(n,Object(h.a)({},e,{$merge:{score:r}})),r]},a.expireDeclare=function(){var e=a.state,t=e.declarer,n=e.selected;if(t&&!K(n)){var r=a.updatePlayerScore(t,-.5),c=Object(o.a)(r,1)[0];a.setState({players:c,declarer:null,timeDeclared:void 0,selected:[]})}},a.markPointForDeclarer=function(e){var t=a.updatePlayerScore(e,1),n=Object(o.a)(t,2),r=n[0],c=n[1],l=a.props.userReducer.user,s=c>=Ge.playingTo?e:"",i={players:r,gameOver:s};if(""!==s){var u=l&&l.uid||"anonymous",m="you"==e?1:0,d=Math.round(((new Date).getTime()-a.state.startTime.getTime())/1e3);Fe.a.post("/api/game",{uid:u,total_time:d,player_won:m,difficulty_level:a.state.difficulty,winning_score:c}).then((function(){console.log("Game sent")})).catch((function(e){console.log("Error sending game")}))}return a.setState(i),i},a.performDeclare=function(e){if(!a.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};a.setState(t),a.setState({undeclareId:window.setTimeout((function(){a.expireDeclare()}),Ge.turnTime)})}},a.updateSelected=function(e,t){var n={setFound:K(e),selected:e,declarer:t};n.setFound&&(a.state.undeclareId&&clearTimeout(a.state.undeclareId),setTimeout((function(){a.removeSet()}),2e3)),a.setState(n)},a.handleCardClick=function(e){var t=a.state,n=t.setFound,r=t.declarer,c=t.myName;if(!n&&"cpu"!==r){var l=J(e,a.state.selected);r||a.performDeclare(c),a.setState({selected:l}),K(l)&&a.updateSelected(l,"you")}},a.handleRedeal=function(){var e=Y(a.state);a.setState(e)},a.removeSet=function(){var e=a.state,t=e.declarer,n=e.selected;if(t&&K(n)){console.log("Set found, removing"),a.markPointForDeclarer(t);var r=Re({setFound:!1,declarer:null,timeDeclared:void 0},q(a.state));a.setState(r)}a.state.cpuTimer&&clearInterval(a.state.cpuTimer),setTimeout((function(){var e=window.setInterval(a.cpuTurn,a.state.cpuTurnInterval);a.setState({cpuTimer:e})}),Ge.cpuDelay)},a.resetGame=function(){a.state.cpuTimer&&window.clearInterval(a.state.cpuTimer),a.setState(Re({},Object(U.cloneDeep)(Ve),{},Ue()))},a.state=Re({},Object(U.cloneDeep)(Ve),{},Ue(),{difficulty:2}),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,n=t.deck,c=t.selected,l=t.declarer,o=t.players,s=t.gameStarted,i=(t.setFound,this.props.userReducer),u=i.user;return i.loading?"Loading...":s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{board:a,deck:n,selected:c,declarer:l,handleCardClick:this.handleCardClick,handleDeclare:function(){},handleRedeal:this.handleRedeal,players:o,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.myName,resetGame:this.resetGame,solo:!0,gameMode:"versus"})):r.a.createElement("div",{className:"container main-content"},null!==u&&r.a.createElement(A,null),r.a.createElement("h3",{className:"text-center mb-4"},"Solo Play vs. Computer"),r.a.createElement("h4",{className:"mb-4"},"Choose difficulty level:"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("form",{onSubmit:this.handleStartGame},r.a.createElement("div",{className:"col-10 col-md-6 mb-5"},r.a.createElement(Ie.a,{maxValue:6,minValue:1,value:this.state.difficulty,onChange:function(t){var a=Ae(t);window.localStorage.setItem("soloDifficulty",t.toString()),e.setState({cpuTurnInterval:a,difficulty:t})}})),r.a.createElement("input",{type:"submit",value:"Start",className:"btn btn-primary"})),r.a.createElement("p",{style:{marginTop:"24px"}},"First to ",Ge.playingTo," points is the winner")),r.a.createElement("div",{className:"row mt-4"},r.a.createElement("ul",{style:{listStyleType:"none"}},r.a.createElement("li",{className:"mb-4"},r.a.createElement(p.b,{to:"/local"},"Local Multiplayer")),r.a.createElement("li",null,r.a.createElement(p.b,{to:"/"},"Back to Main Menu"))))),!u&&r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",null,r.a.createElement("p",null,"To save your game statistics, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:X,className:"btn btn-info"},"Sign in")))))}}]),t}(n.Component),ze=Object(g.b)((function(e){return{userReducer:e.user}}))(_e);function Le(e){var t=e.url,a=e.cardName,n=e.description;return r.a.createElement("div",{className:"col-9 col-md-4"},r.a.createElement(p.b,{to:t},r.a.createElement("div",{className:"card shadow-sm mb-3 mb-md-4"},r.a.createElement(ce,{desc:a}))),r.a.createElement("p",{className:"text-center"},n))}var He=function(){return r.a.createElement("div",{className:"container mt-3 mt-md-5"},r.a.createElement("h1",{className:"d-none d-md-block text-center mb-3 mb-md-5"},"Main Menu"),r.a.createElement("div",{className:"row justify-content-center"},[{url:"/solo",cardName:"0012",description:"Solo/Local"},{url:"/lobby",cardName:"1121",description:"Join Game"},{url:"/host",cardName:"2200",description:"Host Game"}].map((function(e,t){return r.a.createElement(Le,Object.assign({key:"card-".concat(t)},e))}))),r.a.createElement("div",{className:"d-none d-md-block"},r.a.createElement("hr",null),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/rules"},"Rules")),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/stats"},"View Statistics"))))};function We(e){var t=e.desc;return r.a.createElement("div",{className:"col-4 my-2"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:t})))}var Ke=function(){return r.a.createElement("div",{className:"rules container"},r.a.createElement("h2",null,"Rules of the Game"),r.a.createElement("p",null,"The object of the same is to find sets of three cards that are either the same or different along each of four dimensions."),r.a.createElement("p",null,"If that makes perfect sense to you, then go ahead and start playing. Otherwise, I will explain a bit more."),r.a.createElement("p",null,"The game starts by laying out a board with twelve cards. Here are some example cards: "),r.a.createElement("div",{className:"row"},["0000","1210","0022","2101","0120","2011"].map((function(e,t){return r.a.createElement(We,{key:t,desc:e})}))),r.a.createElement("p",null,"You'll notice that every card has four different characteristics:"),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color"),r.a.createElement("li",null,"number"),r.a.createElement("li",null,"shape"),r.a.createElement("li",null,"fill")),r.a.createElement("p",null,"and each of those characteristics has three different possibilities."),r.a.createElement("p",null,"Three cards form a set if, for each of those four characteristics, the three cards are either ",r.a.createElement("em",null,"all the same")," or ",r.a.createElement("em",null,"all different.")),r.a.createElement("p",null,"It is easier to understand with examples, so here is an example set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"0112"})))," ",r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"1111"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"2110"})))),r.a.createElement("p",null,"Which you can describe as follows:"),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - SAME"),r.a.createElement("li",null,"shape - SAME"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - DIFFERENT")),r.a.createElement("p",null,"Therefore, the three cards form a set."),r.a.createElement("p",null,"Here is another set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"2022"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"1112"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"0202"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - SAME")),r.a.createElement("p",null,"This is not a set:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"1220"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"1110"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"2000"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"fill - SAME"),r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - NOT THE SAME OR DIFFERENT!")),r.a.createElement("p",null,"Even though the cards have the same fill, different colors, and different shapes, the numbers are neither ",r.a.createElement("em",null,"all the same")," nor ",r.a.createElement("em",null,"all different"),", so it's not a set."),r.a.createElement("p",null,"It doesn't matter how many of the characteristics are the same, and how many are different, as long as for ",r.a.createElement("em",null,"each")," characteristic, the cards are all the same or all different. Here's one last example:"),r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"1122"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"0201"}))),r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card"},r.a.createElement(ce,{desc:"2010"})))),r.a.createElement("ul",{className:"browser-default"},r.a.createElement("li",null,"color - DIFFERENT"),r.a.createElement("li",null,"shape - DIFFERENT"),r.a.createElement("li",null,"number - DIFFERENT"),r.a.createElement("li",null,"fill - DIFFERENT")),r.a.createElement("p",null,"Each characteristic is different for all three cards, so this is a set."),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/"},"Back Home")))};var $e=function(e){var t=Object(g.d)((function(e){return e.user}));return Object(n.useEffect)((function(){x.auth().getRedirectResult().then((function(e){if(e.credential)var t=e.credential.accessToken;var a=e.user;console.log(t,a)})).catch((function(e){e.code,e.message,e.email,e.credential}))}),[]),t?r.a.createElement("div",{className:"container"},r.a.createElement(A,null)):r.a.createElement("div",{className:"container"},r.a.createElement("button",{onClick:X,className:"btn"},"Sign in"))};function Je(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ye(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Je(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Je(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qe={declareTime:5e3,colors:me,playingTo:6,cpuDelay:1200},Xe=function(){var e=W();return Ye({},Y({deck:e.slice(12),board:e.slice(0,12)}),{selected:[]})},Ze=function(e){for(var t={},a=0;a<e;a++)t[a]={score:0,color:qe.colors[a]};return t},Qe={numPlayers:null,players:Ze(2),gameStarted:!1,name:"1",setFound:!1,declarer:null,timeDeclared:null,gameOver:"",difficulty:2,cpuTurnInterval:1e3,cpuFound:[]},et=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleStartGame=function(e){a.setState({numPlayers:e,players:Ze(e)}),a.setState({gameStarted:!0})},a.updatePlayerScore=function(e,t){var n=a.state.players,r=n[e].score+t;return[N()(n,Object(h.a)({},e,{$merge:{score:r}})),r]},a.expireDeclare=function(){var e=a.state,t=e.declarer,n=e.selected;if(!K(n)){var r=a.updatePlayerScore(t,-.5),c=Object(o.a)(r,1)[0];a.setState({players:c,declarer:null,timeDeclared:null,selected:[]})}},a.markPointForDeclarer=function(e){var t=a.updatePlayerScore(e,1),n=Object(o.a)(t,2),r={players:n[0],gameOver:n[1]>=qe.playingTo?e:""};a.setState(r)},a.performDeclare=function(e){if(!a.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};a.setState(t),a.undeclareID=setTimeout((function(){a.expireDeclare()}),qe.declareTime)}},a.updateSelected=function(e,t){var n={setFound:K(e),selected:e,declarer:t};n.setFound&&(clearTimeout(a.undeclareID),setTimeout((function(){a.removeSet()}),2e3)),a.setState(n)},a.handleCardClick=function(e){var t=a.state,n=t.setFound,r=t.declarer;if(!n&&null!==r){var c=J(e,a.state.selected);a.setState({selected:c}),K(c)&&a.updateSelected(c,r)}},a.handlePlayerClick=function(e){null===a.state.declarer&&a.performDeclare(e)},a.handleRedeal=function(){var e=Y(a.state);a.setState(e)},a.removeSet=function(){var e=a.state,t=e.declarer,n=e.selected;if(K(n)){console.log("Set found, removing");var r=Ye({},a.markPointForDeclarer(t),{setFound:!1,declarer:null,timeDeclared:null},q(a.state));a.setState(r)}clearInterval(a.cpuTimer),setTimeout((function(){a.cpuTimer=setInterval(a.cpuTurn,a.state.cpuTurnInterval)}),qe.cpuDelay)},a.resetGame=function(){clearInterval(a.cpuTimer),a.setState(Ye({},Object(U.cloneDeep)(Qe),{},Xe()))},a.state=Ye({},Object(U.cloneDeep)(Qe),{},Xe()),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,n=t.deck,c=t.selected,l=t.declarer,o=t.players,s=t.numPlayers;t.setFound;return console.log(o),s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{board:a,deck:n,selected:c,declarer:l,handleCardClick:this.handleCardClick,handlePlayerClick:this.handlePlayerClick,handleDeclare:this.handleDeclare,players:o,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,sharedDevice:!0,gameMode:"shared-device"})):r.a.createElement("div",{className:"container"},r.a.createElement("h4",{className:"mb-4"},"Choose Number of Players"),r.a.createElement("div",{className:"row text-center"},Object(B.a)(Array(6).keys()).map((function(t){return r.a.createElement("div",{key:"players-".concat(t),onClick:function(){e.handleStartGame(t+1)},className:"mb-3 col-4"},r.a.createElement("button",{className:"btn btn-info"},t+1))}))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(p.b,{to:"/solo"},"Back"))))}}]),t}(n.Component);var tt=function(e){var t=Object(g.d)((function(e){return e.user})),a=t.user,c=Object(n.useState)(null),l=Object(o.a)(c,2),s=l[0],i=l[1];return Object(g.c)(),Object(n.useEffect)((function(){var e=function(){var e=Object(E.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Fe.a.get("/api/user/stats/".concat(a.uid)).then((function(e){i(e.data)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.loading||null===a||e()}),[t.loading]),t.loading?"Loading...":null===a?r.a.createElement("div",{className:"container mt-4"},r.a.createElement("p",null,"Sign in to view stats"),r.a.createElement("p",null,r.a.createElement("button",{onClick:X,className:"btn btn-info"},"Sign in"))):r.a.createElement("div",{className:"container mt-2 mt-md-4"},r.a.createElement("h3",null,"Statistics"),r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Difficulty"),r.a.createElement("th",null,"Games Played"),r.a.createElement("th",null,"Winning Percentage"))),r.a.createElement("tbody",null,s&&s.map((function(e,t){return r.a.createElement("tr",{key:"stats-".concat(t)},r.a.createElement("td",null,e.difficulty_level),r.a.createElement("td",null,e.games_played),r.a.createElement("td",null,Math.round(e.games_won/e.games_played*100),"%"))})))),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/"},"Main Menu")))},at=a(68),nt=a.n(at),rt=function(e){var t=e.children,a=e.visible;return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{show:a},r.a.createElement(fe.a.Header,null,r.a.createElement(fe.a.Title,null,"Submitting action...")),r.a.createElement(fe.a.Body,null,t),r.a.createElement(fe.a.Footer,null)))};function ct(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ct(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ct(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ot={turnTime:4e3,colors:me,playingTo:6,cpuDelay:1200},st=function(e){var t=function(e){return Math.round((e-3)/3)}(e),a=W();return lt({},Y({deck:a},{boardSize:e,minimumSets:t}),{selected:[]})},it={players:{you:{score:0,color:ot.colors[0]}},gameStarted:!1,name:"you",setFound:!1,gameOver:!1,startTime:null,elapsedTime:null,setsFound:[],setsOnBoard:null,cardsOnBoard:12,popupVisible:!1,popUpText:"SET!"},ut=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleStartGame=function(e){e.preventDefault();var t=a.state.cardsOnBoard,n=st(t),r=new Date;a.setState(lt({gameStarted:!0,startTime:r,elapsedTime:0},n,{setsOnBoard:H(n.board)})),window.timeId=setInterval((function(){var e=Math.round(((new Date).getTime()-r.getTime())/1e3);a.setState({elapsedTime:e})}),1e3)},a.componentDidMount=function(){},a.updatePlayerScore=function(e,t){var n=a.state.players,r=n[e].score+t;return[N()(n,Object(h.a)({},e,{$merge:{score:r}})),r]},a.performDeclare=function(e){if(!a.state.declarer){var t={declarer:e,timeDeclared:(new Date).getTime()};a.setState(t),a.undeclareID=setTimeout((function(){a.expireDeclare()}),ot.turnTime)}},a.updateSelected=function(e,t){var n={setFound:K(e),selected:e,declarer:t};n.setFound&&(clearTimeout(a.undeclareID),setTimeout((function(){a.removeSet()}),2e3)),a.setState(n)},a.handleDeclare=function(){},a.resetLocalSelected=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.setState((function(t){if(3===t.selected.length&&(e||!K(t.selected)))return{selected:[]}}))},a.handleCardClick=function(e){var t=J(e,a.state.selected);3===t.length&&(K(t)?(console.log("Set found"),a.setState((function(e){window.setTimeout((function(){a.setState({popupVisible:!1}),a.resetLocalSelected(!0)}),2e3);var n=e.setsFound;return n.map((function(e){return!Object(U.isEqual)(t.sort(),e)})).every((function(e){return e}))?{setsFound:[].concat(Object(B.a)(n),[t.sort()]),popupVisible:!0,popUpText:"SET!"}:{popupVisible:!0,popUpText:"Already found!"}}))):(console.log("Bad set selected!"),window.setTimeout(a.resetLocalSelected,1200))),a.setState(lt({},{},{selected:t}))},a.handleRedeal=function(){},a.removeSet=function(){var e=a.state,t=e.declarer,n=e.selected;if(K(n)){console.log("Set found, removing");var r=lt({},a.markPointForDeclarer(t),{setFound:!1,declarer:null,timeDeclared:null},q(a.state));a.setState(r)}clearInterval(a.cpuTimer),setTimeout((function(){a.cpuTimer=setInterval(a.cpuTurn,a.state.cpuTurnInterval)}),ot.cpuDelay)},a.resetGame=function(){clearInterval(a.cpuTimer),a.setState(lt({},Object(U.cloneDeep)(it),{},st()))},a.state=lt({},Object(U.cloneDeep)(it)),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.board,c=t.deck,l=t.selected,o=t.declarer,s=t.players,i=t.gameStarted,u=(t.setFound,t.setsFound),m=t.popupVisible,d=this.props.userReducer,f=d.user;return d.loading?"Loading...":i?r.a.createElement(r.a.Fragment,null,r.a.createElement(rt,{visible:m},r.a.createElement("p",{className:"flow-text center-align"},this.state.popUpText)),r.a.createElement(Ee,{board:a,deck:c,selected:l,declarer:o,handleCardClick:this.handleCardClick,handleDeclare:this.handleDeclare,players:s,setFound:this.state.setFound,gameOver:this.state.gameOver,myName:this.state.name,resetGame:this.resetGame,solo:!0,gameMode:"puzzle",setsFound:u,startTime:this.state.startTime,elapsedTime:this.state.elapsedTime})):r.a.createElement("div",{className:"container"},null!==f&&r.a.createElement(A,null),r.a.createElement("h3",null,"Puzzle Mode"),r.a.createElement("p",null,"Find as many sets as you can"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 m4"},r.a.createElement(nt.a,{ref:function(t){e.difficultyInput=t},min:2,max:4,orientation:"horizontal",tooltip:!0,format:function(e){return 3*e},value:Number(this.state.cardsOnBoard)/3,onChange:function(t){e.setState({cardsOnBoard:3*t})}}),r.a.createElement("form",{onSubmit:this.handleStartGame},r.a.createElement("input",{type:"submit",value:"Start",className:"btn"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{style:{marginTop:"48px"},className:"col s12"},r.a.createElement("p",{style:{marginTop:"36px"}},r.a.createElement(p.b,{to:"/solo"},"Back to Solo Menu")),!f&&r.a.createElement(n.Fragment,null,r.a.createElement("hr",null),r.a.createElement("p",null,"To save your stats, sign in with your Google account."),r.a.createElement("p",null,r.a.createElement("button",{onClick:X,className:"btn"},"Sign in")))))))}}]),t}(n.Component),mt=Object(g.b)((function(e){return{userReducer:e.user}}))(ut),dt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(p.a,null,r.a.createElement(f.c,null,r.a.createElement(f.a,{exact:!0,path:"/",component:He}),r.a.createElement(f.a,{path:"/host",component:je}),r.a.createElement(f.a,{path:"/lobby",component:De}),r.a.createElement(f.a,{path:"/guest/:gameName",component:Te}),r.a.createElement(f.a,{path:"/solo",component:ze}),r.a.createElement(f.a,{path:"/local",component:et}),r.a.createElement(f.a,{path:"/rules",component:Ke}),r.a.createElement(f.a,{path:"/login",component:$e}),r.a.createElement(f.a,{path:"/stats",component:tt}),r.a.createElement(f.a,{path:"/puzzle",component:mt}))))}}]),t}(n.Component);var pt=function(e){var t=Object(n.useState)(null),a=Object(o.a)(t,2),c=(a[0],a[1],Object(g.c)());return Object(n.useEffect)((function(){R.a.auth().onAuthStateChanged((function(e){if(e){var t=window.localStorage.getItem("nickname")||e.displayName.split(" ")[0],a={displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,photoURL:e.photoURL,isAnonymous:e.isAnonymous,uid:e.uid,providerData:e.providerData,nickname:t};c(k({loading:!1,user:a})),Fe.a.get("/api/user/".concat(e.uid)).then((function(e){console.log("User is registered")})).catch((function(t){t.response&&404===t.response.status?(console.log("User not registered"),Fe.a.post("/api/user",{uid:e.uid,info:a}).then((function(){console.log("User registered successfully")})).catch((function(e){console.log("Error registering user",e)}))):console.log("An error occurred trying to GET user info")}))}else console.log("Not signed in"),c(k({loading:!1,user:null}))}))}),[]),r.a.createElement(dt,null)};l.a.render(r.a.createElement(g.a,{store:I},r.a.createElement(pt,null)),document.getElementById("root"))},63:function(e,t,a){e.exports=a.p+"static/media/sad_trombone.baad2ca9.mp3"},64:function(e,t,a){e.exports=a.p+"static/media/applause.c2030d5b.mp3"},69:function(e,t,a){e.exports=a(124)},74:function(e,t,a){},85:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.aaa08cae.chunk.js.map